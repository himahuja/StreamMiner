<!DOCTYPE html>
<!-- Generated by Cython 0.28.5 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: shortest_paths.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.28.5</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="shortest_paths.c">shortest_paths.c</a></p>
<div class="cython"><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython code score-13 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_dijkstra_line_33, __pyx_kp_u_dijkstra_csgraph_directed_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="sd">Routines for performing shortest-path graph searches</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="sd">The main interface is in the function :func:`shortest_path`.  This</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: <span class="sd">calls cython routines that compute the shortest path using</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: <span class="sd">the Floyd-Warshall algorithm, Dijkstra&#39;s algorithm with Fibonacci Heaps,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: <span class="sd">the Bellman-Ford algorithm, or Johnson&#39;s Algorithm.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: <span class="c"># Author: Jake Vanderplas  -- &lt;vanderplas@astro.washington.edu&gt;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: <span class="c"># License: BSD, (C) 2011</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: <span class="k">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: <span class="k">import</span> <span class="nn">warnings</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_warnings, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_warnings, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">014</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">016</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: <span class="k">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">csr_matrix</span><span class="p">,</span> <span class="n">isspmatrix</span><span class="p">,</span> <span class="n">isspmatrix_csr</span><span class="p">,</span> <span class="n">isspmatrix_csc</span></pre>
<pre class='cython code score-49 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_csr_matrix);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_csr_matrix);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_csr_matrix);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_isspmatrix);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_isspmatrix);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_isspmatrix);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_isspmatrix_csr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_isspmatrix_csr);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_s_isspmatrix_csr);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_isspmatrix_csc);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_isspmatrix_csc);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_s_isspmatrix_csc);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_sparse, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_csr_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_csr_matrix, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_isspmatrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_isspmatrix, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_isspmatrix_csr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_isspmatrix_csr, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_isspmatrix_csc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_isspmatrix_csc, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>: <span class="k">from</span> <span class="nn">scipy.sparse.csgraph._validation</span> <span class="k">import</span> <span class="n">validate_graph</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_validate_graph);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_validate_graph);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_validate_graph);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_sparse_csgraph__validation, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_validate_graph);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_graph, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">malloc</span><span class="p">,</span> <span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: <span class="k">from</span> <span class="nn">numpy.math</span> <span class="k">cimport</span> <span class="n">INFINITY</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: <span class="k">include</span> <span class="s">&#39;parameters.pxi&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>: <span class="k">class</span> <span class="nc">NegativeCycleError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span></pre>
<pre class='cython code score-18 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CalculateMetaclass</span>(NULL, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_NegativeCycleError, __pyx_n_s_NegativeCycleError, (PyObject *) NULL, __pyx_n_s_algorithms_sm_shortest_paths, (PyObject *) NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_NegativeCycleError, __pyx_t_1, __pyx_t_3, NULL, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_NegativeCycleError, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-48 '>/* Python wrapper */
static PyObject *__pyx_pw_10algorithms_2sm_14shortest_paths_18NegativeCycleError_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10algorithms_2sm_14shortest_paths_18NegativeCycleError_1__init__ = {"__init__", (PyCFunction)__pyx_pw_10algorithms_2sm_14shortest_paths_18NegativeCycleError_1__init__, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10algorithms_2sm_14shortest_paths_18NegativeCycleError_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_message = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_message,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)((PyObject*)__pyx_kp_s_));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_message);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_self = values[0];
    __pyx_v_message = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("algorithms.sm.shortest_paths.NegativeCycleError.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10algorithms_2sm_14shortest_paths_18NegativeCycleError___init__(__pyx_self, __pyx_v_self, __pyx_v_message);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10algorithms_2sm_14shortest_paths_18NegativeCycleError___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_message) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("algorithms.sm.shortest_paths.NegativeCycleError.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_self, __pyx_n_s_message);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
  __pyx_codeobj__18 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__17, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_algorithms_sm_shortest_paths_pyx, __pyx_n_s_init, 30, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_10algorithms_2sm_14shortest_paths_18NegativeCycleError_1__init__, 0, __pyx_n_s_NegativeCycleError___init, NULL, __pyx_n_s_algorithms_sm_shortest_paths, __pyx_d, ((PyObject *)__pyx_codeobj__18));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__19);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_3, __pyx_n_s_init, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_kp_s_));<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">031</span>:         <span class="ne">Exception</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])), __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_self, __pyx_v_message};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_self, __pyx_v_message};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_self);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_message);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_message);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_message);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">032</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>: <span class="k">def</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="n">csgraph</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>/* Python wrapper */
static PyObject *__pyx_pw_10algorithms_2sm_14shortest_paths_1dijkstra(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10algorithms_2sm_14shortest_paths_dijkstra[] = "\n    dijkstra(csgraph, directed=True, indices=None, return_predecessors=False,\n             unweighted=False, limit=np.inf)\n    Dijkstra algorithm using Fibonacci Heaps\n    .. versionadded:: 0.11.0\n    Parameters\n    ----------\n    csgraph : array, matrix, or sparse matrix, 2 dimensions\n        The N x N array of non-negative distances representing the input graph.\n    directed : bool, optional\n        If True (default), then find the shortest path on a directed graph:\n        only move from point i to point j along paths csgraph[i, j] and from\n        point j to i along paths csgraph[j, i].\n        If False, then find the shortest path on an undirected graph: the\n        algorithm can progress from point i to j or j to i along either\n        csgraph[i, j] or csgraph[j, i].\n    indices : array_like or int, optional\n        if specified, only compute the paths for the points at the given\n        indices.\n    return_predecessors : bool, optional\n        If True, return the size (N, N) predecesor matrix\n    unweighted : bool, optional\n        If True, then find unweighted distances.  That is, rather than finding\n        the path between each point such that the sum of weights is minimized,\n        find the path such that the number of edges is minimized.\n    limit : float, optional\n        The maximum distance to calculate, must be &gt;= 0. Using a smaller limit\n        will decrease computation time by aborting calculations between pairs\n        that are separated by a distance &gt; limit. For such pairs, the distance\n        will be equal to np.inf (i.e., not connected).\n        .. versionadded:: 0.14.0\n    Returns\n    -------\n    dist_matrix : ndarray\n        The matrix of distances between graph nodes. dist_matrix[i,j]\n        gives the shortest distance from point i to point j along the graph.\n    predecessors : ndarray\n        Returned only if return_predecessors == True.\n        The matrix of predecessors, which can be used to rec""onstruct\n        the shortest paths.  Row i of the predecessor matrix contains\n        information on the shortest paths from point i: each entry\n        predecessors[i, j] gives the index of the previous node in the\n        path from point i to point j.  If no path exists between point\n        i and j, then predecessors[i, j] = -9999\n    Notes\n    -----\n    As currently implemented, Dijkstra's algorithm does not work for\n    graphs with direction-dependent distances when directed == False.\n    i.e., if csgraph[i,j] and csgraph[j,i] are not equal and\n    both are nonzero, setting directed=False will not yield the correct\n    result.\n    Also, this routine does not work for graphs with negative\n    distances.  Negative distances can lead to infinite cycles that must\n    be handled by specialized algorithms such as Bellman-Ford's algorithm\n    or Johnson's algorithm.\n    Examples\n    --------\n    &gt;&gt;&gt; from scipy.sparse import csr_matrix\n    &gt;&gt;&gt; from scipy.sparse.csgraph import dijkstra\n    &gt;&gt;&gt; graph = [\n    ... [0, 1 , 2, 0],\n    ... [0, 0, 0, 1],\n    ... [0, 0, 0, 3],\n    ... [0, 0, 0, 0]\n    ... ]\n    &gt;&gt;&gt; graph = csr_matrix(graph)\n    &gt;&gt;&gt; print(graph)\n      (0, 1)\t1\n      (0, 2)\t2\n      (1, 3)\t1\n      (2, 3)\t3\n    &gt;&gt;&gt; dist_matrix, predecessors = dijkstra(csgraph=graph, directed=False, indices=0, return_predecessors=True)\n    &gt;&gt;&gt; dist_matrix\n    array([ 0.,  1.,  2.,  2.])\n    &gt;&gt;&gt; predecessors\n    array([-9999,     0,     0,     1], dtype=int32)\n    ";
static PyMethodDef __pyx_mdef_10algorithms_2sm_14shortest_paths_1dijkstra = {"dijkstra", (PyCFunction)__pyx_pw_10algorithms_2sm_14shortest_paths_1dijkstra, METH_VARARGS|METH_KEYWORDS, __pyx_doc_10algorithms_2sm_14shortest_paths_dijkstra};
static PyObject *__pyx_pw_10algorithms_2sm_14shortest_paths_1dijkstra(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_csgraph = 0;
  PyObject *__pyx_v_directed = 0;
  PyObject *__pyx_v_indices = 0;
  PyObject *__pyx_v_return_predecessors = 0;
  PyObject *__pyx_v_unweighted = 0;
  PyObject *__pyx_v_limit = 0;
  PyObject *__pyx_v_target = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dijkstra (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_csgraph,&amp;__pyx_n_s_directed,&amp;__pyx_n_s_indices,&amp;__pyx_n_s_return_predecessors,&amp;__pyx_n_s_unweighted,&amp;__pyx_n_s_limit,&amp;__pyx_n_s_target,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    values[1] = ((PyObject *)Py_True);
    values[2] = ((PyObject *)Py_None);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10algorithms_2sm_14shortest_paths_dijkstra(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_csgraph, PyObject *__pyx_v_directed, PyObject *__pyx_v_indices, PyObject *__pyx_v_return_predecessors, PyObject *__pyx_v_unweighted, PyObject *__pyx_v_limit, PyObject *__pyx_v_target) {
  PyObject *__pyx_v_N = NULL;
  PyObject *__pyx_v_return_shape = NULL;
  __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t __pyx_v_limitf;
  PyObject *__pyx_v_dist_matrix = NULL;
  PyObject *__pyx_v_predecessor_matrix = NULL;
  PyObject *__pyx_v_csr_data = NULL;
  PyObject *__pyx_v_csgraphT = NULL;
  PyObject *__pyx_v_csrT_data = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dijkstra", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_csgraph);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_indices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("algorithms.sm.shortest_paths.dijkstra", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_N);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_return_shape);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dist_matrix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_predecessor_matrix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_csr_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_csgraphT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_csrT_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_csgraph);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_indices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(15, __pyx_n_s_csgraph, __pyx_n_s_directed, __pyx_n_s_indices, __pyx_n_s_return_predecessors, __pyx_n_s_unweighted, __pyx_n_s_limit, __pyx_n_s_target, __pyx_n_s_N, __pyx_n_s_return_shape, __pyx_n_s_limitf, __pyx_n_s_dist_matrix, __pyx_n_s_predecessor_matrix, __pyx_n_s_csr_data, __pyx_n_s_csgraphT, __pyx_n_s_csrT_data);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_10algorithms_2sm_14shortest_paths_1dijkstra, NULL, __pyx_n_s_algorithms_sm_shortest_paths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_dijkstra, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">034</span>:              <span class="n">return_predecessors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    values[3] = ((PyObject *)Py_False);
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>:              <span class="n">unweighted</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>    values[4] = ((PyObject *)Py_False);
    values[5] = __pyx_k__2;
    values[6] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_csgraph)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_directed);
          if (value) { values[1] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_indices);
          if (value) { values[2] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_return_predecessors);
          if (value) { values[3] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_unweighted);
          if (value) { values[4] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_limit);
          if (value) { values[5] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_target);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dijkstra") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_csgraph = values[0];
    __pyx_v_directed = values[1];
    __pyx_v_indices = values[2];
    __pyx_v_return_predecessors = values[3];
    __pyx_v_unweighted = values[4];
    __pyx_v_limit = values[5];
    __pyx_v_target = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dijkstra", 0, 1, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("algorithms.sm.shortest_paths.dijkstra", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10algorithms_2sm_14shortest_paths_dijkstra(__pyx_self, __pyx_v_csgraph, __pyx_v_directed, __pyx_v_indices, __pyx_v_return_predecessors, __pyx_v_unweighted, __pyx_v_limit, __pyx_v_target);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_inf);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_k__2 = __pyx_t_2;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">036</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: <span class="sd">    dijkstra(csgraph, directed=True, indices=None, return_predecessors=False,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: <span class="sd">             unweighted=False, limit=np.inf)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>: <span class="sd">    Dijkstra algorithm using Fibonacci Heaps</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: <span class="sd">    .. versionadded:: 0.11.0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>: <span class="sd">    csgraph : array, matrix, or sparse matrix, 2 dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>: <span class="sd">        The N x N array of non-negative distances representing the input graph.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>: <span class="sd">    directed : bool, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>: <span class="sd">        If True (default), then find the shortest path on a directed graph:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: <span class="sd">        only move from point i to point j along paths csgraph[i, j] and from</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>: <span class="sd">        point j to i along paths csgraph[j, i].</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>: <span class="sd">        If False, then find the shortest path on an undirected graph: the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>: <span class="sd">        algorithm can progress from point i to j or j to i along either</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: <span class="sd">        csgraph[i, j] or csgraph[j, i].</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: <span class="sd">    indices : array_like or int, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: <span class="sd">        if specified, only compute the paths for the points at the given</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>: <span class="sd">        indices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: <span class="sd">    return_predecessors : bool, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>: <span class="sd">        If True, return the size (N, N) predecesor matrix</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>: <span class="sd">    unweighted : bool, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>: <span class="sd">        If True, then find unweighted distances.  That is, rather than finding</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>: <span class="sd">        the path between each point such that the sum of weights is minimized,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>: <span class="sd">        find the path such that the number of edges is minimized.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>: <span class="sd">    limit : float, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>: <span class="sd">        The maximum distance to calculate, must be &gt;= 0. Using a smaller limit</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>: <span class="sd">        will decrease computation time by aborting calculations between pairs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: <span class="sd">        that are separated by a distance &gt; limit. For such pairs, the distance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>: <span class="sd">        will be equal to np.inf (i.e., not connected).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: <span class="sd">        .. versionadded:: 0.14.0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: <span class="sd">    dist_matrix : ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: <span class="sd">        The matrix of distances between graph nodes. dist_matrix[i,j]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: <span class="sd">        gives the shortest distance from point i to point j along the graph.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: <span class="sd">    predecessors : ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: <span class="sd">        Returned only if return_predecessors == True.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: <span class="sd">        The matrix of predecessors, which can be used to reconstruct</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>: <span class="sd">        the shortest paths.  Row i of the predecessor matrix contains</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>: <span class="sd">        information on the shortest paths from point i: each entry</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: <span class="sd">        predecessors[i, j] gives the index of the previous node in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>: <span class="sd">        path from point i to point j.  If no path exists between point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: <span class="sd">        i and j, then predecessors[i, j] = -9999</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>: <span class="sd">    As currently implemented, Dijkstra&#39;s algorithm does not work for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: <span class="sd">    graphs with direction-dependent distances when directed == False.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: <span class="sd">    i.e., if csgraph[i,j] and csgraph[j,i] are not equal and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: <span class="sd">    both are nonzero, setting directed=False will not yield the correct</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>: <span class="sd">    result.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>: <span class="sd">    Also, this routine does not work for graphs with negative</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>: <span class="sd">    distances.  Negative distances can lead to infinite cycles that must</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>: <span class="sd">    be handled by specialized algorithms such as Bellman-Ford&#39;s algorithm</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>: <span class="sd">    or Johnson&#39;s algorithm.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>: <span class="sd">    Examples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>: <span class="sd">    --------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>: <span class="sd">    &gt;&gt;&gt; from scipy.sparse import csr_matrix</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>: <span class="sd">    &gt;&gt;&gt; from scipy.sparse.csgraph import dijkstra</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>: <span class="sd">    &gt;&gt;&gt; graph = [</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>: <span class="sd">    ... [0, 1 , 2, 0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>: <span class="sd">    ... [0, 0, 0, 1],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: <span class="sd">    ... [0, 0, 0, 3],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: <span class="sd">    ... [0, 0, 0, 0]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>: <span class="sd">    ... ]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>: <span class="sd">    &gt;&gt;&gt; graph = csr_matrix(graph)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>: <span class="sd">    &gt;&gt;&gt; print(graph)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: <span class="sd">      (0, 1)	1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: <span class="sd">      (0, 2)	2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: <span class="sd">      (1, 3)	1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>: <span class="sd">      (2, 3)	3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>: <span class="sd">    &gt;&gt;&gt; dist_matrix, predecessors = dijkstra(csgraph=graph, directed=False, indices=0, return_predecessors=True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>: <span class="sd">    &gt;&gt;&gt; dist_matrix</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: <span class="sd">    array([ 0.,  1.,  2.,  2.])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: <span class="sd">    &gt;&gt;&gt; predecessors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>: <span class="sd">    array([-9999,     0,     0,     1], dtype=int32)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>:     <span class="c">#------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>:     <span class="c"># validate csgraph and convert to csr matrix</span></pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:     <span class="n">csgraph</span> <span class="o">=</span> <span class="n">validate_graph</span><span class="p">(</span><span class="n">csgraph</span><span class="p">,</span> <span class="n">directed</span><span class="p">,</span> <span class="n">DTYPE</span><span class="p">,</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_validate_graph);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_csgraph);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_csgraph);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_csgraph);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_directed);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_directed);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_directed);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_csgraph, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:                              <span class="n">dense_output</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dense_output, Py_False) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">117</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:     <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">csgraph</span><span class="o">.</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-55 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_int_0, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_1};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_1};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:         <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Graph has negative weights: dijkstra will give &quot;</span></pre>
<pre class='cython code score-14 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Graph_has_negative_weights_dijks);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">120</span>:                       <span class="s">&quot;inaccurate results if the graph contains negative &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>:                       <span class="s">&quot;cycles. Consider johnson or bellman_ford.&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:     <span class="n">N</span> <span class="o">=</span> <span class="n">csgraph</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_N = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">124</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:     <span class="c">#------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>:     <span class="c"># initialize/validate indices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:     <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (__pyx_v_indices == Py_None);
  __pyx_t_7 = (__pyx_t_6 != 0);
  if (__pyx_t_7) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:         <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ITYPE</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_N);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_N);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_N);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_ITYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_indices, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:         <span class="n">return_shape</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">N</span><span class="p">,)</span></pre>
<pre class='cython code score-16 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_indices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_N);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_N);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_N);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_return_shape = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">130</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:         <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ITYPE</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_indices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_indices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_indices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_ITYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_copy, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_indices, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:         <span class="n">return_shape</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">N</span><span class="p">,)</span></pre>
<pre class='cython code score-16 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_indices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_N);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_N);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_N);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_return_shape = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:         <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-54 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_atleast_1d);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_indices);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_v_indices};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_v_indices};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else
      #endif
      {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_indices);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_indices);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_indices);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_indices, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:         <span class="n">indices</span><span class="p">[</span><span class="n">indices</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">N</span></pre>
<pre class='cython code score-20 '>    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_indices, __pyx_int_0, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_indices, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_4, __pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_indices, __pyx_t_3, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-104" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">indices</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">indices</span> <span class="o">&gt;=</span> <span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-104 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_indices, __pyx_int_0, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_5};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_t_5};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else
      #endif
      {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (!__pyx_t_6) {
    } else {
      __pyx_t_7 = __pyx_t_6;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_indices, __pyx_v_N, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_4};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_t_4};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else
      #endif
      {
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = __pyx_t_6;
    __pyx_L6_bool_binop_done:;
    if (unlikely(__pyx_t_7)) {
/* … */
    }
  }
  __pyx_L4:;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;indices out of range 0...N&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 136, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_indices_out_of_range_0_N);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class="cython line score-0">&#xA0;<span class="">137</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">138</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">limitf</span> <span class="o">=</span> <span class="n">limit</span></pre>
<pre class='cython code score-10 '>  __pyx_t_8 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_limit); if (unlikely((__pyx_t_8 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 138, __pyx_L1_error)</span>
  __pyx_v_limitf = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:     <span class="k">if</span> <span class="n">limitf</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = ((__pyx_v_limitf &lt; 0.0) != 0);
  if (unlikely(__pyx_t_7)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>:         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;limit must be &gt;= 0&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_limit_must_be_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class="cython line score-0">&#xA0;<span class="">141</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>:     <span class="c">#------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>:     <span class="c"># initialize dist_matrix for output</span></pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:     <span class="n">dist_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_indices);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_N);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_N);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_N);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dist_matrix = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:     <span class="n">dist_matrix</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dist_matrix, __pyx_n_s_fill);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_inf);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_2};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_2};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:     <span class="n">dist_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)),</span> <span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-68 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_indices);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_1};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_2, __pyx_t_1};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_indices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_indices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_indices);
  __pyx_t_4 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_dist_matrix, __pyx_t_5, __pyx_int_0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>:     <span class="c">#------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>:     <span class="c"># initialize predecessors for output</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:     <span class="k">if</span> <span class="n">return_predecessors</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_predecessors); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
    goto __pyx_L9;
  }
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:         <span class="n">predecessor_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ITYPE</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_indices);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_N);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_N);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_N);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_ITYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_predecessor_matrix = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:         <span class="n">predecessor_matrix</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">NULL_IDX</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_predecessor_matrix, __pyx_n_s_fill);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_neg_9999);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class="cython line score-0">&#xA0;<span class="">153</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:         <span class="n">predecessor_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">0</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ITYPE</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_N);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_N);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_N);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_ITYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_predecessor_matrix = __pyx_t_4;
    __pyx_t_4 = 0;
  }
  __pyx_L9:;
</pre><pre class="cython line score-0">&#xA0;<span class="">155</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:     <span class="k">if</span> <span class="n">unweighted</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_unweighted); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
    goto __pyx_L10;
  }
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:         <span class="n">csr_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">csgraph</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_1};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_1};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else
      #endif
      {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_csr_data = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">158</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>:         <span class="n">csr_data</span> <span class="o">=</span> <span class="n">csgraph</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-2 '>  /*else*/ {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_v_csr_data = __pyx_t_4;
    __pyx_t_4 = 0;
  }
  __pyx_L10:;
</pre><pre class="cython line score-0">&#xA0;<span class="">160</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>:     <span class="k">if</span> <span class="n">directed</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_directed); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 161, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:         <span class="n">_dijkstra_directed</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>    if (!(likely(((__pyx_v_indices) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_indices, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 162, __pyx_L1_error)</span>
/* … */
    __pyx_t_2 = __pyx_f_10algorithms_2sm_14shortest_paths__dijkstra_directed(((PyArrayObject *)__pyx_v_indices), ((PyArrayObject *)__pyx_v_csr_data), ((PyArrayObject *)__pyx_t_4), ((PyArrayObject *)__pyx_t_5), ((PyArrayObject *)__pyx_v_dist_matrix), ((PyArrayObject *)__pyx_v_predecessor_matrix), __pyx_v_limitf, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:                            <span class="n">csr_data</span><span class="p">,</span> <span class="n">csgraph</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">csgraph</span><span class="o">.</span><span class="n">indptr</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>    if (!(likely(((__pyx_v_csr_data) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_csr_data, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_indices);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:                            <span class="n">dist_matrix</span><span class="p">,</span> <span class="n">predecessor_matrix</span><span class="p">,</span> <span class="n">limitf</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    if (!(likely(((__pyx_v_dist_matrix) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_dist_matrix, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
    if (!(likely(((__pyx_v_predecessor_matrix) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_predecessor_matrix, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
    __pyx_t_10 = __Pyx_PyInt_As_npy_int32(__pyx_v_target); if (unlikely((__pyx_t_10 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">165</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:         <span class="n">csgraphT</span> <span class="o">=</span> <span class="n">csgraph</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tocsr</span><span class="p">()</span></pre>
<pre class='cython code score-21 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_tocsr);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 166, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 166, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_csgraphT = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">167</span>:         <span class="k">if</span> <span class="n">unweighted</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_unweighted); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 167, __pyx_L1_error)</span>
    if (__pyx_t_7) {
/* … */
      goto __pyx_L12;
    }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>:             <span class="n">csrT_data</span> <span class="o">=</span> <span class="n">csr_data</span></pre>
<pre class='cython code score-1 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_csr_data);
      __pyx_v_csrT_data = __pyx_v_csr_data;
</pre><pre class="cython line score-0">&#xA0;<span class="">169</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:             <span class="n">csrT_data</span> <span class="o">=</span> <span class="n">csgraphT</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-2 '>    /*else*/ {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraphT, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_v_csrT_data = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    __pyx_L12:;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>:         <span class="n">_dijkstra_undirected</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>    if (!(likely(((__pyx_v_indices) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_indices, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 171, __pyx_L1_error)</span>
/* … */
    __pyx_t_3 = __pyx_f_10algorithms_2sm_14shortest_paths__dijkstra_undirected(((PyArrayObject *)__pyx_v_indices), ((PyArrayObject *)__pyx_v_csr_data), ((PyArrayObject *)__pyx_t_2), ((PyArrayObject *)__pyx_t_4), ((PyArrayObject *)__pyx_v_csrT_data), ((PyArrayObject *)__pyx_t_5), ((PyArrayObject *)__pyx_t_1), ((PyArrayObject *)__pyx_v_dist_matrix), ((PyArrayObject *)__pyx_v_predecessor_matrix), __pyx_v_limitf);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_L11:;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:                              <span class="n">csr_data</span><span class="p">,</span> <span class="n">csgraph</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">csgraph</span><span class="o">.</span><span class="n">indptr</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>    if (!(likely(((__pyx_v_csr_data) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_csr_data, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 172, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_indices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 172, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 172, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraph, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 172, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 172, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:                              <span class="n">csrT_data</span><span class="p">,</span> <span class="n">csgraphT</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">csgraphT</span><span class="o">.</span><span class="n">indptr</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>    if (!(likely(((__pyx_v_csrT_data) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_csrT_data, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraphT, __pyx_n_s_indices);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csgraphT, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span>
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:                              <span class="n">dist_matrix</span><span class="p">,</span> <span class="n">predecessor_matrix</span><span class="p">,</span> <span class="n">limitf</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>    if (!(likely(((__pyx_v_dist_matrix) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_dist_matrix, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
    if (!(likely(((__pyx_v_predecessor_matrix) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_predecessor_matrix, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">175</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:     <span class="k">if</span> <span class="n">return_predecessors</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_predecessors); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:         <span class="k">return</span> <span class="p">(</span><span class="n">dist_matrix</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">return_shape</span><span class="p">),</span></pre>
<pre class='cython code score-47 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dist_matrix, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_return_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_v_return_shape};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_v_return_shape};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      } else
      #endif
      {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_return_shape);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_return_shape);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_return_shape);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
    __pyx_t_3 = 0;
    __pyx_t_1 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:                 <span class="n">predecessor_matrix</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">return_shape</span><span class="p">))</span></pre>
<pre class='cython code score-39 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_predecessor_matrix, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_return_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_v_return_shape};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_5, __pyx_v_return_shape};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else
      #endif
      {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_return_shape);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_return_shape);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_return_shape);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">179</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>:         <span class="k">return</span> <span class="n">dist_matrix</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">return_shape</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_dist_matrix, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_return_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_v_return_shape};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_v_return_shape};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else
      #endif
      {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_return_shape);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_return_shape);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_return_shape);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">181</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>: <span class="k">cdef</span> <span class="nf">_dijkstra_directed</span><span class="p">(</span></pre>
<pre class='cython code score-45 '>static PyObject *__pyx_f_10algorithms_2sm_14shortest_paths__dijkstra_directed(PyArrayObject *__pyx_v_source_indices, PyArrayObject *__pyx_v_csr_weights, PyArrayObject *__pyx_v_csr_indices, PyArrayObject *__pyx_v_csr_indptr, PyArrayObject *__pyx_v_dist_matrix, PyArrayObject *__pyx_v_pred, __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t __pyx_v_limit, __pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t __pyx_v_target) {
  unsigned int __pyx_v_Nind;
  unsigned int __pyx_v_N;
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_k;
  unsigned int __pyx_v_j_source;
  unsigned int __pyx_v_j_current;
  __pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t __pyx_v_j;
  __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t __pyx_v_next_val;
  int __pyx_v_return_pred;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciHeap __pyx_v_heap;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_v;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_current_node;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_nodes;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csr_indices;
  __Pyx_Buffer __pyx_pybuffer_csr_indices;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csr_indptr;
  __Pyx_Buffer __pyx_pybuffer_csr_indptr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csr_weights;
  __Pyx_Buffer __pyx_pybuffer_csr_weights;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dist_matrix;
  __Pyx_Buffer __pyx_pybuffer_dist_matrix;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_pred;
  __Pyx_Buffer __pyx_pybuffer_pred;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_source_indices;
  __Pyx_Buffer __pyx_pybuffer_source_indices;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_dijkstra_directed", 0);
  __pyx_pybuffer_source_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_source_indices.refcount = 0;
  __pyx_pybuffernd_source_indices.data = NULL;
  __pyx_pybuffernd_source_indices.rcbuffer = &amp;__pyx_pybuffer_source_indices;
  __pyx_pybuffer_csr_weights.pybuffer.buf = NULL;
  __pyx_pybuffer_csr_weights.refcount = 0;
  __pyx_pybuffernd_csr_weights.data = NULL;
  __pyx_pybuffernd_csr_weights.rcbuffer = &amp;__pyx_pybuffer_csr_weights;
  __pyx_pybuffer_csr_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_csr_indices.refcount = 0;
  __pyx_pybuffernd_csr_indices.data = NULL;
  __pyx_pybuffernd_csr_indices.rcbuffer = &amp;__pyx_pybuffer_csr_indices;
  __pyx_pybuffer_csr_indptr.pybuffer.buf = NULL;
  __pyx_pybuffer_csr_indptr.refcount = 0;
  __pyx_pybuffernd_csr_indptr.data = NULL;
  __pyx_pybuffernd_csr_indptr.rcbuffer = &amp;__pyx_pybuffer_csr_indptr;
  __pyx_pybuffer_dist_matrix.pybuffer.buf = NULL;
  __pyx_pybuffer_dist_matrix.refcount = 0;
  __pyx_pybuffernd_dist_matrix.data = NULL;
  __pyx_pybuffernd_dist_matrix.rcbuffer = &amp;__pyx_pybuffer_dist_matrix;
  __pyx_pybuffer_pred.pybuffer.buf = NULL;
  __pyx_pybuffer_pred.refcount = 0;
  __pyx_pybuffernd_pred.data = NULL;
  __pyx_pybuffernd_pred.rcbuffer = &amp;__pyx_pybuffer_pred;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_source_indices, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 183, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_source_indices.diminfo[0].strides = __pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_source_indices.diminfo[0].shape = __pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csr_weights, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 183, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csr_weights.diminfo[0].strides = __pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csr_weights.diminfo[0].shape = __pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csr_indices, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 183, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csr_indices.diminfo[0].strides = __pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csr_indices.diminfo[0].shape = __pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csr_indptr, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 183, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csr_indptr.diminfo[0].strides = __pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csr_indptr.diminfo[0].shape = __pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_dist_matrix, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 183, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_dist_matrix.diminfo[0].strides = __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dist_matrix.diminfo[0].shape = __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_dist_matrix.diminfo[1].strides = __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_dist_matrix.diminfo[1].shape = __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_pred, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 183, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_pred.diminfo[0].strides = __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_pred.diminfo[0].shape = __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_pred.diminfo[1].strides = __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_pred.diminfo[1].shape = __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("algorithms.sm.shortest_paths._dijkstra_directed", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">184</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">source_indices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csr_weights</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csr_indices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csr_indptr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">dist_matrix</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">pred</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">190</span>:             <span class="n">DTYPE_t</span> <span class="n">limit</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>:             <span class="n">ITYPE_t</span> <span class="n">target</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">192</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">Nind</span> <span class="o">=</span> <span class="n">dist_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_Nind = (__pyx_v_dist_matrix-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="n">dist_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_dist_matrix-&gt;dimensions[1]);
</pre><pre class="cython line score-0">&#xA0;<span class="">194</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">j_source</span><span class="p">,</span> <span class="nf">j_current</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">197</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">next_val</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">return_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_pred), __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_return_pred = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">200</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>:     <span class="k">cdef</span> <span class="kt">FibonacciHeap</span> <span class="nf">heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">202</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">v</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">203</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">current_node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span>* <span class="nf">nodes</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FibonacciNode</span><span class="o">*&gt;</span> <span class="n">malloc</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nodes = ((struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">205</span>:                                                         <span class="n">sizeof</span><span class="p">(</span><span class="n">FibonacciNode</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">206</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nind</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_Nind;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         <span class="n">j_source</span> <span class="o">=</span> <span class="n">source_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (unlikely(__pyx_t_7 &gt;= (size_t)__pyx_pybuffernd_source_indices.diminfo[0].shape)) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
    }
    __pyx_v_j_source = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_source_indices.diminfo[0].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">209</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:         <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_N;
    __pyx_t_9 = __pyx_t_8;
    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_k = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:             <span class="n">initialize_node</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_initialize_node((&amp;(__pyx_v_nodes[__pyx_v_k])), __pyx_v_k, NULL);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">212</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:         <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_source</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = __pyx_v_j_source;
    __pyx_t_3 = -1;
    if (unlikely(__pyx_t_11 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[0].shape)) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_12 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[1].shape)) __pyx_t_3 = 1;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
    }
    *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t *, __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_dist_matrix.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_dist_matrix.diminfo[1].strides) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:         <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    __pyx_v_heap.min_node = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:         <span class="n">insert_node</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">j_source</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10algorithms_2sm_14shortest_paths_insert_node((&amp;__pyx_v_heap), (&amp;(__pyx_v_nodes[__pyx_v_j_source])));
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:         <span class="k">while</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_13 = (__pyx_v_heap.min_node != 0);
      if (!__pyx_t_13) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:             <span class="n">v</span> <span class="o">=</span> <span class="n">remove_min</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_v = __pyx_f_10algorithms_2sm_14shortest_paths_remove_min((&amp;__pyx_v_heap));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:             <span class="n">v</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">SCANNED</span></pre>
<pre class='cython code score-0 '>      __pyx_v_v-&gt;state = __pyx_e_10algorithms_2sm_14shortest_paths_SCANNED;
</pre><pre class="cython line score-0">&#xA0;<span class="">220</span>:             <span class="c"># Early stop on reaching target</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:             <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = ((__pyx_v_v-&gt;index == __pyx_v_target) != 0);
      if (__pyx_t_13) {
/* … */
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:                 <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">val</span></pre>
<pre class='cython code score-2 '>        __pyx_t_14 = __pyx_v_v-&gt;val;
        __pyx_t_15 = __pyx_v_i;
        __pyx_t_16 = __pyx_v_v-&gt;index;
        __pyx_t_3 = -1;
        if (unlikely(__pyx_t_15 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[0].shape)) __pyx_t_3 = 0;
        if (unlikely(__pyx_t_16 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[1].shape)) __pyx_t_3 = 1;
        if (unlikely(__pyx_t_3 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
          <span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span>
        }
        *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t *, __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dist_matrix.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dist_matrix.diminfo[1].strides) = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L8_break;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">csr_indptr</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">csr_indptr</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-4 '>      __pyx_t_17 = (__pyx_v_v-&gt;index + 1);
      __pyx_t_3 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_pybuffernd_csr_indptr.diminfo[0].shape;
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_3 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_pybuffernd_csr_indptr.diminfo[0].shape)) __pyx_t_3 = 0;
      if (unlikely(__pyx_t_3 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
        <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
      }
      __pyx_t_18 = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_csr_indptr.diminfo[0].strides));
      __pyx_t_19 = __pyx_v_v-&gt;index;
      __pyx_t_3 = -1;
      if (unlikely(__pyx_t_19 &gt;= (size_t)__pyx_pybuffernd_csr_indptr.diminfo[0].shape)) __pyx_t_3 = 0;
      if (unlikely(__pyx_t_3 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
        <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
      }
      __pyx_t_20 = __pyx_t_18;
      for (__pyx_t_21 = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_csr_indptr.diminfo[0].strides)); __pyx_t_21 &lt; __pyx_t_20; __pyx_t_21+=1) {
        __pyx_v_j = __pyx_t_21;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:                 <span class="n">j_current</span> <span class="o">=</span> <span class="n">csr_indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>        __pyx_t_22 = __pyx_v_j;
        __pyx_t_3 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_pybuffernd_csr_indices.diminfo[0].shape;
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_3 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_pybuffernd_csr_indices.diminfo[0].shape)) __pyx_t_3 = 0;
        if (unlikely(__pyx_t_3 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
          <span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span>
        }
        __pyx_v_j_current = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_csr_indices.diminfo[0].strides));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:                 <span class="n">current_node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">j_current</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_v_current_node = (&amp;(__pyx_v_nodes[__pyx_v_j_current]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:                 <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">SCANNED</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = ((__pyx_v_current_node-&gt;state != __pyx_e_10algorithms_2sm_14shortest_paths_SCANNED) != 0);
        if (__pyx_t_13) {
/* … */
        }
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:                     <span class="n">next_val</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">val</span> <span class="o">+</span> <span class="n">csr_weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>          __pyx_t_23 = __pyx_v_j;
          __pyx_t_3 = -1;
          if (__pyx_t_23 &lt; 0) {
            __pyx_t_23 += __pyx_pybuffernd_csr_weights.diminfo[0].shape;
            if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_3 = 0;
          } else if (unlikely(__pyx_t_23 &gt;= __pyx_pybuffernd_csr_weights.diminfo[0].shape)) __pyx_t_3 = 0;
          if (unlikely(__pyx_t_3 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
            <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
          }
          __pyx_v_next_val = (__pyx_v_v-&gt;val + (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t *, __pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_csr_weights.diminfo[0].strides)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:                     <span class="k">if</span> <span class="n">next_val</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = ((__pyx_v_next_val &lt;= __pyx_v_limit) != 0);
          if (__pyx_t_13) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:                         <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">NOT_IN_HEAP</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = ((__pyx_v_current_node-&gt;state == __pyx_e_10algorithms_2sm_14shortest_paths_NOT_IN_HEAP) != 0);
            if (__pyx_t_13) {
/* … */
              goto __pyx_L14;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:                             <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">IN_HEAP</span></pre>
<pre class='cython code score-0 '>              __pyx_v_current_node-&gt;state = __pyx_e_10algorithms_2sm_14shortest_paths_IN_HEAP;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:                             <span class="n">current_node</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">next_val</span></pre>
<pre class='cython code score-0 '>              __pyx_v_current_node-&gt;val = __pyx_v_next_val;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:                             <span class="n">insert_node</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">,</span> <span class="n">current_node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>              __pyx_f_10algorithms_2sm_14shortest_paths_insert_node((&amp;__pyx_v_heap), __pyx_v_current_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:                             <span class="k">if</span> <span class="n">return_pred</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_13 = (__pyx_v_return_pred != 0);
              if (__pyx_t_13) {
/* … */
              }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:                                 <span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_current</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-2 '>                __pyx_t_8 = __pyx_v_v-&gt;index;
                __pyx_t_24 = __pyx_v_i;
                __pyx_t_25 = __pyx_v_j_current;
                __pyx_t_3 = -1;
                if (unlikely(__pyx_t_24 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[0].shape)) __pyx_t_3 = 0;
                if (unlikely(__pyx_t_25 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[1].shape)) __pyx_t_3 = 1;
                if (unlikely(__pyx_t_3 != -1)) {
                  <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
                  <span class='error_goto'>__PYX_ERR(0, 235, __pyx_L1_error)</span>
                }
                *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_pred.diminfo[0].strides, __pyx_t_25, __pyx_pybuffernd_pred.diminfo[1].strides) = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:                         <span class="k">elif</span> <span class="n">current_node</span><span class="o">.</span><span class="n">val</span> <span class="o">&gt;</span> <span class="n">next_val</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = ((__pyx_v_current_node-&gt;val &gt; __pyx_v_next_val) != 0);
            if (__pyx_t_13) {
/* … */
            }
            __pyx_L14:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:                             <span class="n">decrease_val</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">,</span> <span class="n">current_node</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>              __pyx_f_10algorithms_2sm_14shortest_paths_decrease_val((&amp;__pyx_v_heap), __pyx_v_current_node, __pyx_v_next_val);
</pre><pre class="cython line score-0">&#xA0;<span class="">238</span>:                                          <span class="n">next_val</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:                             <span class="k">if</span> <span class="n">return_pred</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_13 = (__pyx_v_return_pred != 0);
              if (__pyx_t_13) {
/* … */
              }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:                                 <span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_current</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-2 '>                __pyx_t_8 = __pyx_v_v-&gt;index;
                __pyx_t_26 = __pyx_v_i;
                __pyx_t_27 = __pyx_v_j_current;
                __pyx_t_3 = -1;
                if (unlikely(__pyx_t_26 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[0].shape)) __pyx_t_3 = 0;
                if (unlikely(__pyx_t_27 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[1].shape)) __pyx_t_3 = 1;
                if (unlikely(__pyx_t_3 != -1)) {
                  <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
                  <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
                }
                *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_pred.diminfo[0].strides, __pyx_t_27, __pyx_pybuffernd_pred.diminfo[1].strides) = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">241</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">242</span>:             <span class="c">#v has now been scanned: add the distance to the results</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:             <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">val</span></pre>
<pre class='cython code score-2 '>      __pyx_t_14 = __pyx_v_v-&gt;val;
      __pyx_t_28 = __pyx_v_i;
      __pyx_t_29 = __pyx_v_v-&gt;index;
      __pyx_t_3 = -1;
      if (unlikely(__pyx_t_28 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[0].shape)) __pyx_t_3 = 0;
      if (unlikely(__pyx_t_29 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[1].shape)) __pyx_t_3 = 1;
      if (unlikely(__pyx_t_3 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
        <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L1_error)</span>
      }
      *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t *, __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_dist_matrix.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_dist_matrix.diminfo[1].strides) = __pyx_t_14;
    }
    __pyx_L8_break:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">244</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:     <span class="n">free</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_nodes);
</pre><pre class="cython line score-0">&#xA0;<span class="">246</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">247</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>: <span class="k">cdef</span> <span class="nf">_dijkstra_undirected</span><span class="p">(</span></pre>
<pre class='cython code score-63 '>static PyObject *__pyx_f_10algorithms_2sm_14shortest_paths__dijkstra_undirected(PyArrayObject *__pyx_v_source_indices, PyArrayObject *__pyx_v_csr_weights, PyArrayObject *__pyx_v_csr_indices, PyArrayObject *__pyx_v_csr_indptr, PyArrayObject *__pyx_v_csrT_weights, PyArrayObject *__pyx_v_csrT_indices, PyArrayObject *__pyx_v_csrT_indptr, PyArrayObject *__pyx_v_dist_matrix, PyArrayObject *__pyx_v_pred, __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t __pyx_v_limit) {
  unsigned int __pyx_v_Nind;
  unsigned int __pyx_v_N;
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_k;
  unsigned int __pyx_v_j_source;
  unsigned int __pyx_v_j_current;
  __pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t __pyx_v_j;
  __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t __pyx_v_next_val;
  int __pyx_v_return_pred;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciHeap __pyx_v_heap;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_v;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_current_node;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_nodes;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csrT_indices;
  __Pyx_Buffer __pyx_pybuffer_csrT_indices;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csrT_indptr;
  __Pyx_Buffer __pyx_pybuffer_csrT_indptr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csrT_weights;
  __Pyx_Buffer __pyx_pybuffer_csrT_weights;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csr_indices;
  __Pyx_Buffer __pyx_pybuffer_csr_indices;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csr_indptr;
  __Pyx_Buffer __pyx_pybuffer_csr_indptr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_csr_weights;
  __Pyx_Buffer __pyx_pybuffer_csr_weights;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_dist_matrix;
  __Pyx_Buffer __pyx_pybuffer_dist_matrix;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_pred;
  __Pyx_Buffer __pyx_pybuffer_pred;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_source_indices;
  __Pyx_Buffer __pyx_pybuffer_source_indices;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_dijkstra_undirected", 0);
  __pyx_pybuffer_source_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_source_indices.refcount = 0;
  __pyx_pybuffernd_source_indices.data = NULL;
  __pyx_pybuffernd_source_indices.rcbuffer = &amp;__pyx_pybuffer_source_indices;
  __pyx_pybuffer_csr_weights.pybuffer.buf = NULL;
  __pyx_pybuffer_csr_weights.refcount = 0;
  __pyx_pybuffernd_csr_weights.data = NULL;
  __pyx_pybuffernd_csr_weights.rcbuffer = &amp;__pyx_pybuffer_csr_weights;
  __pyx_pybuffer_csr_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_csr_indices.refcount = 0;
  __pyx_pybuffernd_csr_indices.data = NULL;
  __pyx_pybuffernd_csr_indices.rcbuffer = &amp;__pyx_pybuffer_csr_indices;
  __pyx_pybuffer_csr_indptr.pybuffer.buf = NULL;
  __pyx_pybuffer_csr_indptr.refcount = 0;
  __pyx_pybuffernd_csr_indptr.data = NULL;
  __pyx_pybuffernd_csr_indptr.rcbuffer = &amp;__pyx_pybuffer_csr_indptr;
  __pyx_pybuffer_csrT_weights.pybuffer.buf = NULL;
  __pyx_pybuffer_csrT_weights.refcount = 0;
  __pyx_pybuffernd_csrT_weights.data = NULL;
  __pyx_pybuffernd_csrT_weights.rcbuffer = &amp;__pyx_pybuffer_csrT_weights;
  __pyx_pybuffer_csrT_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_csrT_indices.refcount = 0;
  __pyx_pybuffernd_csrT_indices.data = NULL;
  __pyx_pybuffernd_csrT_indices.rcbuffer = &amp;__pyx_pybuffer_csrT_indices;
  __pyx_pybuffer_csrT_indptr.pybuffer.buf = NULL;
  __pyx_pybuffer_csrT_indptr.refcount = 0;
  __pyx_pybuffernd_csrT_indptr.data = NULL;
  __pyx_pybuffernd_csrT_indptr.rcbuffer = &amp;__pyx_pybuffer_csrT_indptr;
  __pyx_pybuffer_dist_matrix.pybuffer.buf = NULL;
  __pyx_pybuffer_dist_matrix.refcount = 0;
  __pyx_pybuffernd_dist_matrix.data = NULL;
  __pyx_pybuffernd_dist_matrix.rcbuffer = &amp;__pyx_pybuffer_dist_matrix;
  __pyx_pybuffer_pred.pybuffer.buf = NULL;
  __pyx_pybuffer_pred.refcount = 0;
  __pyx_pybuffernd_pred.data = NULL;
  __pyx_pybuffernd_pred.rcbuffer = &amp;__pyx_pybuffer_pred;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_source_indices, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_source_indices.diminfo[0].strides = __pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_source_indices.diminfo[0].shape = __pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csr_weights, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csr_weights.diminfo[0].strides = __pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csr_weights.diminfo[0].shape = __pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csr_indices, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csr_indices.diminfo[0].strides = __pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csr_indices.diminfo[0].shape = __pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csr_indptr, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csr_indptr.diminfo[0].strides = __pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csr_indptr.diminfo[0].shape = __pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csrT_weights.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csrT_weights, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csrT_weights.diminfo[0].strides = __pyx_pybuffernd_csrT_weights.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csrT_weights.diminfo[0].shape = __pyx_pybuffernd_csrT_weights.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csrT_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csrT_indices, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csrT_indices.diminfo[0].strides = __pyx_pybuffernd_csrT_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csrT_indices.diminfo[0].shape = __pyx_pybuffernd_csrT_indices.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_csrT_indptr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_csrT_indptr, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_csrT_indptr.diminfo[0].strides = __pyx_pybuffernd_csrT_indptr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_csrT_indptr.diminfo[0].shape = __pyx_pybuffernd_csrT_indptr.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_dist_matrix, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_dist_matrix.diminfo[0].strides = __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dist_matrix.diminfo[0].shape = __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_dist_matrix.diminfo[1].strides = __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_dist_matrix.diminfo[1].shape = __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_pred, &amp;__Pyx_TypeInfo_nn___pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t, PyBUF_FORMAT| PyBUF_C_CONTIGUOUS| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_pred.diminfo[0].strides = __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_pred.diminfo[0].shape = __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_pred.diminfo[1].strides = __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_pred.diminfo[1].shape = __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csrT_indices.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csrT_indptr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csrT_weights.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("algorithms.sm.shortest_paths._dijkstra_undirected", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csrT_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csrT_indptr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csrT_weights.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">249</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">source_indices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csr_weights</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csr_indices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">252</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csr_indptr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">253</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csrT_weights</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">254</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csrT_indices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">255</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">csrT_indptr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">256</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">DTYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">dist_matrix</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">257</span>:             <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">ITYPE_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="n">pred</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>:             <span class="n">DTYPE_t</span> <span class="n">limit</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">Nind</span> <span class="o">=</span> <span class="n">dist_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_Nind = (__pyx_v_dist_matrix-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="n">dist_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_dist_matrix-&gt;dimensions[1]);
</pre><pre class="cython line score-0">&#xA0;<span class="">261</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">j_source</span><span class="p">,</span> <span class="nf">j_current</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">262</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">263</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">264</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">next_val</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">265</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">return_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_pred), __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_return_pred = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">267</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">268</span>:     <span class="k">cdef</span> <span class="kt">FibonacciHeap</span> <span class="nf">heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">269</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">v</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">270</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">current_node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span>* <span class="nf">nodes</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">FibonacciNode</span><span class="o">*&gt;</span> <span class="n">malloc</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nodes = ((struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">272</span>:                                                         <span class="n">sizeof</span><span class="p">(</span><span class="n">FibonacciNode</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">273</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nind</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_Nind;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:         <span class="n">j_source</span> <span class="o">=</span> <span class="n">source_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (unlikely(__pyx_t_7 &gt;= (size_t)__pyx_pybuffernd_source_indices.diminfo[0].shape)) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 275, __pyx_L1_error)</span>
    }
    __pyx_v_j_source = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_source_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_source_indices.diminfo[0].strides));
</pre><pre class="cython line score-0">&#xA0;<span class="">276</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:         <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_N;
    __pyx_t_9 = __pyx_t_8;
    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_k = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:             <span class="n">initialize_node</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_initialize_node((&amp;(__pyx_v_nodes[__pyx_v_k])), __pyx_v_k, NULL);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">279</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:         <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_source</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = __pyx_v_j_source;
    __pyx_t_3 = -1;
    if (unlikely(__pyx_t_11 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[0].shape)) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_12 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[1].shape)) __pyx_t_3 = 1;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>
    }
    *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t *, __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_dist_matrix.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_dist_matrix.diminfo[1].strides) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:         <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    __pyx_v_heap.min_node = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:         <span class="n">insert_node</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">j_source</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10algorithms_2sm_14shortest_paths_insert_node((&amp;__pyx_v_heap), (&amp;(__pyx_v_nodes[__pyx_v_j_source])));
</pre><pre class="cython line score-0">&#xA0;<span class="">283</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:         <span class="k">while</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_13 = (__pyx_v_heap.min_node != 0);
      if (!__pyx_t_13) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:             <span class="n">v</span> <span class="o">=</span> <span class="n">remove_min</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_v = __pyx_f_10algorithms_2sm_14shortest_paths_remove_min((&amp;__pyx_v_heap));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:             <span class="n">v</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">SCANNED</span></pre>
<pre class='cython code score-0 '>      __pyx_v_v-&gt;state = __pyx_e_10algorithms_2sm_14shortest_paths_SCANNED;
</pre><pre class="cython line score-0">&#xA0;<span class="">287</span>:             <span class="c">## Stopping here</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">csr_indptr</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">csr_indptr</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-4 '>      __pyx_t_14 = (__pyx_v_v-&gt;index + 1);
      __pyx_t_3 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_pybuffernd_csr_indptr.diminfo[0].shape;
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_3 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_pybuffernd_csr_indptr.diminfo[0].shape)) __pyx_t_3 = 0;
      if (unlikely(__pyx_t_3 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
        <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
      }
      __pyx_t_15 = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_csr_indptr.diminfo[0].strides));
      __pyx_t_16 = __pyx_v_v-&gt;index;
      __pyx_t_3 = -1;
      if (unlikely(__pyx_t_16 &gt;= (size_t)__pyx_pybuffernd_csr_indptr.diminfo[0].shape)) __pyx_t_3 = 0;
      if (unlikely(__pyx_t_3 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
        <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
      }
      __pyx_t_17 = __pyx_t_15;
      for (__pyx_t_18 = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csr_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_csr_indptr.diminfo[0].strides)); __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
        __pyx_v_j = __pyx_t_18;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:                 <span class="n">j_current</span> <span class="o">=</span> <span class="n">csr_indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>        __pyx_t_19 = __pyx_v_j;
        __pyx_t_3 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_pybuffernd_csr_indices.diminfo[0].shape;
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_3 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_pybuffernd_csr_indices.diminfo[0].shape)) __pyx_t_3 = 0;
        if (unlikely(__pyx_t_3 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
          <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>
        }
        __pyx_v_j_current = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csr_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_csr_indices.diminfo[0].strides));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:                 <span class="n">current_node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">j_current</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_v_current_node = (&amp;(__pyx_v_nodes[__pyx_v_j_current]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:                 <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">SCANNED</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = ((__pyx_v_current_node-&gt;state != __pyx_e_10algorithms_2sm_14shortest_paths_SCANNED) != 0);
        if (__pyx_t_13) {
/* … */
        }
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:                     <span class="n">next_val</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">val</span> <span class="o">+</span> <span class="n">csr_weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>          __pyx_t_20 = __pyx_v_j;
          __pyx_t_3 = -1;
          if (__pyx_t_20 &lt; 0) {
            __pyx_t_20 += __pyx_pybuffernd_csr_weights.diminfo[0].shape;
            if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_3 = 0;
          } else if (unlikely(__pyx_t_20 &gt;= __pyx_pybuffernd_csr_weights.diminfo[0].shape)) __pyx_t_3 = 0;
          if (unlikely(__pyx_t_3 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
            <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>
          }
          __pyx_v_next_val = (__pyx_v_v-&gt;val + (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t *, __pyx_pybuffernd_csr_weights.rcbuffer-&gt;pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_csr_weights.diminfo[0].strides)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:                     <span class="k">if</span> <span class="n">next_val</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = ((__pyx_v_next_val &lt;= __pyx_v_limit) != 0);
          if (__pyx_t_13) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:                         <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">NOT_IN_HEAP</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = ((__pyx_v_current_node-&gt;state == __pyx_e_10algorithms_2sm_14shortest_paths_NOT_IN_HEAP) != 0);
            if (__pyx_t_13) {
/* … */
              goto __pyx_L13;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:                             <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">IN_HEAP</span></pre>
<pre class='cython code score-0 '>              __pyx_v_current_node-&gt;state = __pyx_e_10algorithms_2sm_14shortest_paths_IN_HEAP;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:                             <span class="n">current_node</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">next_val</span></pre>
<pre class='cython code score-0 '>              __pyx_v_current_node-&gt;val = __pyx_v_next_val;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:                             <span class="n">insert_node</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">,</span> <span class="n">current_node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>              __pyx_f_10algorithms_2sm_14shortest_paths_insert_node((&amp;__pyx_v_heap), __pyx_v_current_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:                             <span class="k">if</span> <span class="n">return_pred</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_13 = (__pyx_v_return_pred != 0);
              if (__pyx_t_13) {
/* … */
              }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:                                 <span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_current</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-2 '>                __pyx_t_8 = __pyx_v_v-&gt;index;
                __pyx_t_21 = __pyx_v_i;
                __pyx_t_22 = __pyx_v_j_current;
                __pyx_t_3 = -1;
                if (unlikely(__pyx_t_21 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[0].shape)) __pyx_t_3 = 0;
                if (unlikely(__pyx_t_22 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[1].shape)) __pyx_t_3 = 1;
                if (unlikely(__pyx_t_3 != -1)) {
                  <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
                  <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
                }
                *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_pred.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_pred.diminfo[1].strides) = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:                         <span class="k">elif</span> <span class="n">current_node</span><span class="o">.</span><span class="n">val</span> <span class="o">&gt;</span> <span class="n">next_val</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = ((__pyx_v_current_node-&gt;val &gt; __pyx_v_next_val) != 0);
            if (__pyx_t_13) {
/* … */
            }
            __pyx_L13:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>:                             <span class="n">decrease_val</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">,</span> <span class="n">current_node</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>              __pyx_f_10algorithms_2sm_14shortest_paths_decrease_val((&amp;__pyx_v_heap), __pyx_v_current_node, __pyx_v_next_val);
</pre><pre class="cython line score-0">&#xA0;<span class="">302</span>:                                          <span class="n">next_val</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">303</span>:                             <span class="k">if</span> <span class="n">return_pred</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_13 = (__pyx_v_return_pred != 0);
              if (__pyx_t_13) {
/* … */
              }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">304</span>:                                 <span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_current</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-2 '>                __pyx_t_8 = __pyx_v_v-&gt;index;
                __pyx_t_23 = __pyx_v_i;
                __pyx_t_24 = __pyx_v_j_current;
                __pyx_t_3 = -1;
                if (unlikely(__pyx_t_23 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[0].shape)) __pyx_t_3 = 0;
                if (unlikely(__pyx_t_24 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[1].shape)) __pyx_t_3 = 1;
                if (unlikely(__pyx_t_3 != -1)) {
                  <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
                  <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
                }
                *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_pred.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_pred.diminfo[1].strides) = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">305</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">csrT_indptr</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">csrT_indptr</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-4 '>      __pyx_t_25 = (__pyx_v_v-&gt;index + 1);
      __pyx_t_3 = -1;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_pybuffernd_csrT_indptr.diminfo[0].shape;
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_3 = 0;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_pybuffernd_csrT_indptr.diminfo[0].shape)) __pyx_t_3 = 0;
      if (unlikely(__pyx_t_3 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
        <span class='error_goto'>__PYX_ERR(0, 306, __pyx_L1_error)</span>
      }
      __pyx_t_15 = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csrT_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_csrT_indptr.diminfo[0].strides));
      __pyx_t_26 = __pyx_v_v-&gt;index;
      __pyx_t_3 = -1;
      if (unlikely(__pyx_t_26 &gt;= (size_t)__pyx_pybuffernd_csrT_indptr.diminfo[0].shape)) __pyx_t_3 = 0;
      if (unlikely(__pyx_t_3 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
        <span class='error_goto'>__PYX_ERR(0, 306, __pyx_L1_error)</span>
      }
      __pyx_t_17 = __pyx_t_15;
      for (__pyx_t_18 = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csrT_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_csrT_indptr.diminfo[0].strides)); __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
        __pyx_v_j = __pyx_t_18;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:                 <span class="n">j_current</span> <span class="o">=</span> <span class="n">csrT_indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>        __pyx_t_27 = __pyx_v_j;
        __pyx_t_3 = -1;
        if (__pyx_t_27 &lt; 0) {
          __pyx_t_27 += __pyx_pybuffernd_csrT_indices.diminfo[0].shape;
          if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_3 = 0;
        } else if (unlikely(__pyx_t_27 &gt;= __pyx_pybuffernd_csrT_indices.diminfo[0].shape)) __pyx_t_3 = 0;
        if (unlikely(__pyx_t_3 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
          <span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>
        }
        __pyx_v_j_current = (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_csrT_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_csrT_indices.diminfo[0].strides));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:                 <span class="n">current_node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">j_current</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_v_current_node = (&amp;(__pyx_v_nodes[__pyx_v_j_current]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:                 <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">SCANNED</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = ((__pyx_v_current_node-&gt;state != __pyx_e_10algorithms_2sm_14shortest_paths_SCANNED) != 0);
        if (__pyx_t_13) {
/* … */
        }
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">310</span>:                     <span class="n">next_val</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">val</span> <span class="o">+</span> <span class="n">csrT_weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>          __pyx_t_28 = __pyx_v_j;
          __pyx_t_3 = -1;
          if (__pyx_t_28 &lt; 0) {
            __pyx_t_28 += __pyx_pybuffernd_csrT_weights.diminfo[0].shape;
            if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_3 = 0;
          } else if (unlikely(__pyx_t_28 &gt;= __pyx_pybuffernd_csrT_weights.diminfo[0].shape)) __pyx_t_3 = 0;
          if (unlikely(__pyx_t_3 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
            <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>
          }
          __pyx_v_next_val = (__pyx_v_v-&gt;val + (*__Pyx_BufPtrCContig1d(__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t *, __pyx_pybuffernd_csrT_weights.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_csrT_weights.diminfo[0].strides)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:                     <span class="k">if</span> <span class="n">next_val</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = ((__pyx_v_next_val &lt;= __pyx_v_limit) != 0);
          if (__pyx_t_13) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>:                         <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">NOT_IN_HEAP</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = ((__pyx_v_current_node-&gt;state == __pyx_e_10algorithms_2sm_14shortest_paths_NOT_IN_HEAP) != 0);
            if (__pyx_t_13) {
/* … */
              goto __pyx_L20;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:                             <span class="n">current_node</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">IN_HEAP</span></pre>
<pre class='cython code score-0 '>              __pyx_v_current_node-&gt;state = __pyx_e_10algorithms_2sm_14shortest_paths_IN_HEAP;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:                             <span class="n">current_node</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">next_val</span></pre>
<pre class='cython code score-0 '>              __pyx_v_current_node-&gt;val = __pyx_v_next_val;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:                             <span class="n">insert_node</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">,</span> <span class="n">current_node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>              __pyx_f_10algorithms_2sm_14shortest_paths_insert_node((&amp;__pyx_v_heap), __pyx_v_current_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:                             <span class="k">if</span> <span class="n">return_pred</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_13 = (__pyx_v_return_pred != 0);
              if (__pyx_t_13) {
/* … */
              }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:                                 <span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_current</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-2 '>                __pyx_t_8 = __pyx_v_v-&gt;index;
                __pyx_t_29 = __pyx_v_i;
                __pyx_t_30 = __pyx_v_j_current;
                __pyx_t_3 = -1;
                if (unlikely(__pyx_t_29 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[0].shape)) __pyx_t_3 = 0;
                if (unlikely(__pyx_t_30 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[1].shape)) __pyx_t_3 = 1;
                if (unlikely(__pyx_t_3 != -1)) {
                  <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
                  <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
                }
                *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_pred.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_pred.diminfo[1].strides) = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:                         <span class="k">elif</span> <span class="n">current_node</span><span class="o">.</span><span class="n">val</span> <span class="o">&gt;</span> <span class="n">next_val</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = ((__pyx_v_current_node-&gt;val &gt; __pyx_v_next_val) != 0);
            if (__pyx_t_13) {
/* … */
            }
            __pyx_L20:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:                             <span class="n">decrease_val</span><span class="p">(</span><span class="o">&amp;</span><span class="n">heap</span><span class="p">,</span> <span class="n">current_node</span><span class="p">,</span> <span class="n">next_val</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>              __pyx_f_10algorithms_2sm_14shortest_paths_decrease_val((&amp;__pyx_v_heap), __pyx_v_current_node, __pyx_v_next_val);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:                             <span class="k">if</span> <span class="n">return_pred</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_13 = (__pyx_v_return_pred != 0);
              if (__pyx_t_13) {
/* … */
              }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>:                                 <span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j_current</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-2 '>                __pyx_t_8 = __pyx_v_v-&gt;index;
                __pyx_t_31 = __pyx_v_i;
                __pyx_t_32 = __pyx_v_j_current;
                __pyx_t_3 = -1;
                if (unlikely(__pyx_t_31 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[0].shape)) __pyx_t_3 = 0;
                if (unlikely(__pyx_t_32 &gt;= (size_t)__pyx_pybuffernd_pred.diminfo[1].shape)) __pyx_t_3 = 1;
                if (unlikely(__pyx_t_3 != -1)) {
                  <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
                  <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>
                }
                *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_ITYPE_t *, __pyx_pybuffernd_pred.rcbuffer-&gt;pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_pred.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_pred.diminfo[1].strides) = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>:             <span class="c">#v has now been scanned: add the distance to the results</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:             <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">val</span></pre>
<pre class='cython code score-2 '>      __pyx_t_33 = __pyx_v_v-&gt;val;
      __pyx_t_34 = __pyx_v_i;
      __pyx_t_35 = __pyx_v_v-&gt;index;
      __pyx_t_3 = -1;
      if (unlikely(__pyx_t_34 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[0].shape)) __pyx_t_3 = 0;
      if (unlikely(__pyx_t_35 &gt;= (size_t)__pyx_pybuffernd_dist_matrix.diminfo[1].shape)) __pyx_t_3 = 1;
      if (unlikely(__pyx_t_3 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
        <span class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>
      }
      *__Pyx_BufPtrCContig2d(__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t *, __pyx_pybuffernd_dist_matrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_dist_matrix.diminfo[0].strides, __pyx_t_35, __pyx_pybuffernd_dist_matrix.diminfo[1].strides) = __pyx_t_33;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">325</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:     <span class="n">free</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_nodes);
</pre><pre class="cython line score-0">&#xA0;<span class="">327</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">328</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>: <span class="c">######################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">330</span>: <span class="c"># FibonacciNode structure</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">331</span>: <span class="c">#  This structure and the operations on it are the nodes of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">332</span>: <span class="c">#  Fibonacci heap.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">333</span>: <span class="c">#</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>: <span class="k">cdef</span> <span class="k">enum</span> <span class="nf">FibonacciState</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>enum __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciState {
  __pyx_e_10algorithms_2sm_14shortest_paths_SCANNED,
  __pyx_e_10algorithms_2sm_14shortest_paths_NOT_IN_HEAP,
  __pyx_e_10algorithms_2sm_14shortest_paths_IN_HEAP
};
</pre><pre class="cython line score-0">&#xA0;<span class="">335</span>:     <span class="n">SCANNED</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">336</span>:     <span class="n">NOT_IN_HEAP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">337</span>:     <span class="n">IN_HEAP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">338</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">339</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">FibonacciNode</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode {
  unsigned int index;
  unsigned int rank;
  enum __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciState state;
  __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t val;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *parent;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *left_sibling;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *right_sibling;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *children;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">341</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">index</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">rank</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>:     <span class="n">FibonacciState</span> <span class="n">state</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">344</span>:     <span class="n">DTYPE_t</span> <span class="n">val</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>:     <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">parent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>:     <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">left_sibling</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>:     <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">right_sibling</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>:     <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">children</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">351</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">initialize_node</span><span class="p">(</span><span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_10algorithms_2sm_14shortest_paths_initialize_node(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node, unsigned int __pyx_v_index, struct __pyx_opt_args_10algorithms_2sm_14shortest_paths_initialize_node *__pyx_optional_args) {
  __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t __pyx_v_val = ((__pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t)0.0);
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("initialize_node", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_val = __pyx_optional_args-&gt;val;
    }
  }
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
/* … */
struct __pyx_opt_args_10algorithms_2sm_14shortest_paths_initialize_node {
  int __pyx_n;
  __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t val;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">352</span>:                           <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">index</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">353</span>:                           <span class="n">DTYPE_t</span> <span class="n">val</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">354</span>:     <span class="c"># Assumptions: - node is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">355</span>:     <span class="c">#              - node is not currently part of a heap</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>:     <span class="n">node</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;index = __pyx_v_index;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:     <span class="n">node</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">val</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;val = __pyx_v_val;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:     <span class="n">node</span><span class="o">.</span><span class="n">rank</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;rank = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:     <span class="n">node</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NOT_IN_HEAP</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;state = __pyx_e_10algorithms_2sm_14shortest_paths_NOT_IN_HEAP;
</pre><pre class="cython line score-0">&#xA0;<span class="">360</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:     <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;parent = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>:     <span class="n">node</span><span class="o">.</span><span class="n">left_sibling</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;left_sibling = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:     <span class="n">node</span><span class="o">.</span><span class="n">right_sibling</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;right_sibling = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:     <span class="n">node</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;children = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">365</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">366</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>: <span class="k">cdef</span> <span class="kt">FibonacciNode</span>* <span class="nf">rightmost_sibling</span><span class="p">(</span><span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_f_10algorithms_2sm_14shortest_paths_rightmost_sibling(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node) {
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_temp;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rightmost_sibling", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">368</span>:     <span class="c"># Assumptions: - node is a valid pointer</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span>* <span class="nf">temp</span> <span class="o">=</span> <span class="n">node</span></pre>
<pre class='cython code score-0 '>  __pyx_v_temp = __pyx_v_node;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:     <span class="k">while</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">right_sibling</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (__pyx_v_temp-&gt;right_sibling != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:         <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">right_sibling</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_temp-&gt;right_sibling;
    __pyx_v_temp = __pyx_t_2;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:     <span class="k">return</span> <span class="n">temp</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_temp;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">373</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">374</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">375</span>: <span class="k">cdef</span> <span class="kt">FibonacciNode</span>* <span class="nf">leftmost_sibling</span><span class="p">(</span><span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_f_10algorithms_2sm_14shortest_paths_leftmost_sibling(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node) {
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_temp;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("leftmost_sibling", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">376</span>:     <span class="c"># Assumptions: - node is a valid pointer</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span>* <span class="nf">temp</span> <span class="o">=</span> <span class="n">node</span></pre>
<pre class='cython code score-0 '>  __pyx_v_temp = __pyx_v_node;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">378</span>:     <span class="k">while</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">left_sibling</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (__pyx_v_temp-&gt;left_sibling != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">379</span>:         <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">left_sibling</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_temp-&gt;left_sibling;
    __pyx_v_temp = __pyx_t_2;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:     <span class="k">return</span> <span class="n">temp</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_temp;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">381</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">382</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">add_child</span><span class="p">(</span><span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">,</span> <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">new_child</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_10algorithms_2sm_14shortest_paths_add_child(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node, struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_new_child) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_child", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">384</span>:     <span class="c"># Assumptions: - node is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>:     <span class="c">#              - new_child is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">386</span>:     <span class="c">#              - new_child is not the sibling or child of another node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">387</span>:     <span class="n">new_child</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">node</span></pre>
<pre class='cython code score-0 '>  __pyx_v_new_child-&gt;parent = __pyx_v_node;
</pre><pre class="cython line score-0">&#xA0;<span class="">388</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">389</span>:     <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_node-&gt;children != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:         <span class="n">add_sibling</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">,</span> <span class="n">new_child</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10algorithms_2sm_14shortest_paths_add_sibling(__pyx_v_node-&gt;children, __pyx_v_new_child);
</pre><pre class="cython line score-0">&#xA0;<span class="">391</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:         <span class="n">node</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="n">new_child</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_node-&gt;children = __pyx_v_new_child;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">393</span>:         <span class="n">new_child</span><span class="o">.</span><span class="n">right_sibling</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    __pyx_v_new_child-&gt;right_sibling = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">394</span>:         <span class="n">new_child</span><span class="o">.</span><span class="n">left_sibling</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    __pyx_v_new_child-&gt;left_sibling = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">395</span>:         <span class="n">node</span><span class="o">.</span><span class="n">rank</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_node-&gt;rank = 1;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">396</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">397</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">398</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">add_sibling</span><span class="p">(</span><span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">,</span> <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">new_sibling</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_10algorithms_2sm_14shortest_paths_add_sibling(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node, struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_new_sibling) {
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_temp;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_sibling", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">399</span>:     <span class="c"># Assumptions: - node is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">400</span>:     <span class="c">#              - new_sibling is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">401</span>:     <span class="c">#              - new_sibling is not the child or sibling of another node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span>* <span class="nf">temp</span> <span class="o">=</span> <span class="n">rightmost_sibling</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_temp = __pyx_f_10algorithms_2sm_14shortest_paths_rightmost_sibling(__pyx_v_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">403</span>:     <span class="n">temp</span><span class="o">.</span><span class="n">right_sibling</span> <span class="o">=</span> <span class="n">new_sibling</span></pre>
<pre class='cython code score-0 '>  __pyx_v_temp-&gt;right_sibling = __pyx_v_new_sibling;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">404</span>:     <span class="n">new_sibling</span><span class="o">.</span><span class="n">left_sibling</span> <span class="o">=</span> <span class="n">temp</span></pre>
<pre class='cython code score-0 '>  __pyx_v_new_sibling-&gt;left_sibling = __pyx_v_temp;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:     <span class="n">new_sibling</span><span class="o">.</span><span class="n">right_sibling</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_new_sibling-&gt;right_sibling = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">406</span>:     <span class="n">new_sibling</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_node-&gt;parent;
  __pyx_v_new_sibling-&gt;parent = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">407</span>:     <span class="k">if</span> <span class="n">new_sibling</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_new_sibling-&gt;parent != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">408</span>:         <span class="n">new_sibling</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rank</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_new_sibling-&gt;parent-&gt;rank = (__pyx_v_new_sibling-&gt;parent-&gt;rank + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">409</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">410</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">411</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">remove</span><span class="p">(</span><span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_10algorithms_2sm_14shortest_paths_remove(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("remove", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">412</span>:     <span class="c"># Assumptions: - node is a valid pointer</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>:     <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_node-&gt;parent != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">414</span>:         <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">rank</span> <span class="o">-=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_node-&gt;parent-&gt;rank = (__pyx_v_node-&gt;parent-&gt;rank - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">415</span>:         <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left_sibling</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_node-&gt;left_sibling != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">416</span>:             <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left_sibling</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_node-&gt;left_sibling;
      __pyx_v_node-&gt;parent-&gt;children = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">417</span>:         <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">right_sibling</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_node-&gt;right_sibling != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">418</span>:             <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right_sibling</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_node-&gt;right_sibling;
      __pyx_v_node-&gt;parent-&gt;children = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">419</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">420</span>:             <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_node-&gt;parent-&gt;children = NULL;
    }
    __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">421</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">422</span>:     <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left_sibling</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_node-&gt;left_sibling != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">423</span>:         <span class="n">node</span><span class="o">.</span><span class="n">left_sibling</span><span class="o">.</span><span class="n">right_sibling</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">right_sibling</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_node-&gt;right_sibling;
    __pyx_v_node-&gt;left_sibling-&gt;right_sibling = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">424</span>:     <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">right_sibling</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_node-&gt;right_sibling != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">425</span>:         <span class="n">node</span><span class="o">.</span><span class="n">right_sibling</span><span class="o">.</span><span class="n">left_sibling</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">left_sibling</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_node-&gt;left_sibling;
    __pyx_v_node-&gt;right_sibling-&gt;left_sibling = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">426</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">427</span>:     <span class="n">node</span><span class="o">.</span><span class="n">left_sibling</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;left_sibling = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">428</span>:     <span class="n">node</span><span class="o">.</span><span class="n">right_sibling</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;right_sibling = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">429</span>:     <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;parent = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">430</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">431</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">432</span>: <span class="c">######################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>: <span class="c"># FibonacciHeap structure</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">434</span>: <span class="c">#  This structure and operations on it use the FibonacciNode</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">435</span>: <span class="c">#  routines to implement a Fibonacci heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">436</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">437</span>: <span class="k">ctypedef</span> <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">pFibonacciNode</span></pre>
<pre class='cython code score-0 '>typedef struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_t_10algorithms_2sm_14shortest_paths_pFibonacciNode;
</pre><pre class="cython line score-0">&#xA0;<span class="">438</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">439</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">440</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">FibonacciHeap</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">441</span>:     <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">min_node</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">442</span>:     <span class="n">pFibonacciNode</span><span class="p">[</span><span class="mf">100</span><span class="p">]</span> <span class="n">roots_by_rank</span>  <span class="c"># maximum number of nodes is ~2^100.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">443</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">444</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">445</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">insert_node</span><span class="p">(</span><span class="n">FibonacciHeap</span><span class="o">*</span> <span class="n">heap</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_10algorithms_2sm_14shortest_paths_insert_node(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciHeap *__pyx_v_heap, struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert_node", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">446</span>:                       <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">447</span>:     <span class="c"># Assumptions: - heap is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">448</span>:     <span class="c">#              - node is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">449</span>:     <span class="c">#              - node is not the child or sibling of another node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">450</span>:     <span class="k">if</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_heap-&gt;min_node != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">451</span>:         <span class="n">add_sibling</span><span class="p">(</span><span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10algorithms_2sm_14shortest_paths_add_sibling(__pyx_v_heap-&gt;min_node, __pyx_v_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">452</span>:         <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">val</span> <span class="o">&lt;</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="o">.</span><span class="n">val</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_node-&gt;val &lt; __pyx_v_heap-&gt;min_node-&gt;val) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">453</span>:             <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span> <span class="o">=</span> <span class="n">node</span></pre>
<pre class='cython code score-0 '>      __pyx_v_heap-&gt;min_node = __pyx_v_node;
</pre><pre class="cython line score-0">&#xA0;<span class="">454</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">455</span>:         <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span> <span class="o">=</span> <span class="n">node</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_heap-&gt;min_node = __pyx_v_node;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">456</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">457</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">458</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">decrease_val</span><span class="p">(</span><span class="n">FibonacciHeap</span><span class="o">*</span> <span class="n">heap</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_10algorithms_2sm_14shortest_paths_decrease_val(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciHeap *__pyx_v_heap, struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node, __pyx_t_10algorithms_2sm_14shortest_paths_DTYPE_t __pyx_v_newval) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decrease_val", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">459</span>:                        <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">460</span>:                        <span class="n">DTYPE_t</span> <span class="n">newval</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">461</span>:     <span class="c"># Assumptions: - heap is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">462</span>:     <span class="c">#              - newval &lt;= node.val</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">463</span>:     <span class="c">#              - node is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">464</span>:     <span class="c">#              - node is not the child or sibling of another node</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">465</span>:     <span class="c">#              - node is in the heap</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">466</span>:     <span class="n">node</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">newval</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;val = __pyx_v_newval;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:     <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="ow">and</span> <span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">val</span> <span class="o">&gt;=</span> <span class="n">newval</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_node-&gt;parent != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_node-&gt;parent-&gt;val &gt;= __pyx_v_newval) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:         <span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10algorithms_2sm_14shortest_paths_remove(__pyx_v_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">469</span>:         <span class="n">insert_node</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10algorithms_2sm_14shortest_paths_insert_node(__pyx_v_heap, __pyx_v_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>:     <span class="k">elif</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="o">.</span><span class="n">val</span> <span class="o">&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">val</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_heap-&gt;min_node-&gt;val &gt; __pyx_v_node-&gt;val) != 0);
  if (__pyx_t_1) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:         <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span> <span class="o">=</span> <span class="n">node</span></pre>
<pre class='cython code score-0 '>    __pyx_v_heap-&gt;min_node = __pyx_v_node;
</pre><pre class="cython line score-0">&#xA0;<span class="">472</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">473</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">link</span><span class="p">(</span><span class="n">FibonacciHeap</span><span class="o">*</span> <span class="n">heap</span><span class="p">,</span> <span class="n">FibonacciNode</span><span class="o">*</span> <span class="n">node</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_10algorithms_2sm_14shortest_paths_link(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciHeap *__pyx_v_heap, struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_node) {
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_linknode;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("link", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">475</span>:     <span class="c"># Assumptions: - heap is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">476</span>:     <span class="c">#              - node is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">477</span>:     <span class="c">#              - node is already within heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">479</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">linknode</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">480</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">parent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">481</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">child</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">482</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>:     <span class="k">if</span> <span class="n">heap</span><span class="o">.</span><span class="n">roots_by_rank</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">rank</span><span class="p">]</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_heap-&gt;roots_by_rank[__pyx_v_node-&gt;rank]) == NULL) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>:         <span class="n">heap</span><span class="o">.</span><span class="n">roots_by_rank</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">rank</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_heap-&gt;roots_by_rank[__pyx_v_node-&gt;rank]) = __pyx_v_node;
</pre><pre class="cython line score-0">&#xA0;<span class="">485</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>:         <span class="n">linknode</span> <span class="o">=</span> <span class="n">heap</span><span class="o">.</span><span class="n">roots_by_rank</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">rank</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_linknode = (__pyx_v_heap-&gt;roots_by_rank[__pyx_v_node-&gt;rank]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">487</span>:         <span class="n">heap</span><span class="o">.</span><span class="n">roots_by_rank</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">rank</span><span class="p">]</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_heap-&gt;roots_by_rank[__pyx_v_node-&gt;rank]) = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">488</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:         <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">val</span> <span class="o">&lt;</span> <span class="n">linknode</span><span class="o">.</span><span class="n">val</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node-&gt;val &lt; __pyx_v_linknode-&gt;val) != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node == __pyx_v_heap-&gt;min_node) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L5_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:             <span class="n">remove</span><span class="p">(</span><span class="n">linknode</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_remove(__pyx_v_linknode);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:             <span class="n">add_child</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">linknode</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_add_child(__pyx_v_node, __pyx_v_linknode);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:             <span class="n">link</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_link(__pyx_v_heap, __pyx_v_node);
</pre><pre class="cython line score-0">&#xA0;<span class="">493</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>:             <span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_f_10algorithms_2sm_14shortest_paths_remove(__pyx_v_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">495</span>:             <span class="n">add_child</span><span class="p">(</span><span class="n">linknode</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_add_child(__pyx_v_linknode, __pyx_v_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">496</span>:             <span class="n">link</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="n">linknode</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_link(__pyx_v_heap, __pyx_v_linknode);
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">498</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">499</span>: <span class="k">cdef</span> <span class="kt">FibonacciNode</span>* <span class="nf">remove_min</span><span class="p">(</span><span class="n">FibonacciHeap</span><span class="o">*</span> <span class="n">heap</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_f_10algorithms_2sm_14shortest_paths_remove_min(struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciHeap *__pyx_v_heap) {
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_temp;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_temp_right;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_v_out;
  unsigned int __pyx_v_i;
  struct __pyx_t_10algorithms_2sm_14shortest_paths_FibonacciNode *__pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("remove_min", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">500</span>:     <span class="c"># Assumptions: - heap is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">501</span>:     <span class="c">#              - heap.min_node is a valid pointer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">502</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">temp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">503</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">temp_right</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">504</span>:     <span class="k">cdef</span> <span class="kt">FibonacciNode</span> *<span class="nf">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">505</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">506</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">507</span>:     <span class="c"># make all min_node children into root nodes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">508</span>:     <span class="k">if</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_heap-&gt;min_node-&gt;children != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:         <span class="n">temp</span> <span class="o">=</span> <span class="n">leftmost_sibling</span><span class="p">(</span><span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp = __pyx_f_10algorithms_2sm_14shortest_paths_leftmost_sibling(__pyx_v_heap-&gt;min_node-&gt;children);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>:         <span class="n">temp_right</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp_right = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">511</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">512</span>:         <span class="k">while</span> <span class="n">temp</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_1 = (__pyx_v_temp != 0);
      if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>:             <span class="n">temp_right</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">right_sibling</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_temp-&gt;right_sibling;
      __pyx_v_temp_right = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">514</span>:             <span class="n">remove</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_remove(__pyx_v_temp);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">515</span>:             <span class="n">add_sibling</span><span class="p">(</span><span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10algorithms_2sm_14shortest_paths_add_sibling(__pyx_v_heap-&gt;min_node, __pyx_v_temp);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">516</span>:             <span class="n">temp</span> <span class="o">=</span> <span class="n">temp_right</span></pre>
<pre class='cython code score-0 '>      __pyx_v_temp = __pyx_v_temp_right;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">517</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">518</span>:         <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    __pyx_v_heap-&gt;min_node-&gt;children = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">519</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">520</span>:     <span class="c"># choose a root node other than min_node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">521</span>:     <span class="n">temp</span> <span class="o">=</span> <span class="n">leftmost_sibling</span><span class="p">(</span><span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_temp = __pyx_f_10algorithms_2sm_14shortest_paths_leftmost_sibling(__pyx_v_heap-&gt;min_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">522</span>:     <span class="k">if</span> <span class="n">temp</span> <span class="o">==</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_temp == __pyx_v_heap-&gt;min_node) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">523</span>:         <span class="k">if</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="o">.</span><span class="n">right_sibling</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_heap-&gt;min_node-&gt;right_sibling != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">524</span>:             <span class="n">temp</span> <span class="o">=</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="o">.</span><span class="n">right_sibling</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_heap-&gt;min_node-&gt;right_sibling;
      __pyx_v_temp = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">525</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">526</span>:             <span class="n">out</span> <span class="o">=</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_2 = __pyx_v_heap-&gt;min_node;
      __pyx_v_out = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">527</span>:             <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>      __pyx_v_heap-&gt;min_node = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">528</span>:             <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>      __pyx_r = __pyx_v_out;
      goto __pyx_L0;
    }
    __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">529</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">530</span>:     <span class="c"># remove min_node, and point heap to the new min</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">531</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_heap-&gt;min_node;
  __pyx_v_out = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">532</span>:     <span class="n">remove</span><span class="p">(</span><span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_10algorithms_2sm_14shortest_paths_remove(__pyx_v_heap-&gt;min_node);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">533</span>:     <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span> <span class="o">=</span> <span class="n">temp</span></pre>
<pre class='cython code score-0 '>  __pyx_v_heap-&gt;min_node = __pyx_v_temp;
</pre><pre class="cython line score-0">&#xA0;<span class="">534</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">535</span>:     <span class="c"># re-link the heap</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">536</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">100</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_3 = 0; __pyx_t_3 &lt; 0x64; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">537</span>:         <span class="n">heap</span><span class="o">.</span><span class="n">roots_by_rank</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_heap-&gt;roots_by_rank[__pyx_v_i]) = NULL;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">538</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">539</span>:     <span class="k">while</span> <span class="n">temp</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (__pyx_v_temp != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">540</span>:         <span class="k">if</span> <span class="n">temp</span><span class="o">.</span><span class="n">val</span> <span class="o">&lt;</span> <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span><span class="o">.</span><span class="n">val</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_temp-&gt;val &lt; __pyx_v_heap-&gt;min_node-&gt;val) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">541</span>:             <span class="n">heap</span><span class="o">.</span><span class="n">min_node</span> <span class="o">=</span> <span class="n">temp</span></pre>
<pre class='cython code score-0 '>      __pyx_v_heap-&gt;min_node = __pyx_v_temp;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">542</span>:         <span class="n">temp_right</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">right_sibling</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_temp-&gt;right_sibling;
    __pyx_v_temp_right = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">543</span>:         <span class="n">link</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10algorithms_2sm_14shortest_paths_link(__pyx_v_heap, __pyx_v_temp);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">544</span>:         <span class="n">temp</span> <span class="o">=</span> <span class="n">temp_right</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp = __pyx_v_temp_right;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">545</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">546</span>:     <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">547</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">548</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">549</span>: <span class="c">######################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">550</span>: <span class="c"># Debugging: Functions for printing the Fibonacci heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">551</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">552</span>: <span class="c">#cdef void print_node(FibonacciNode* node, int level=0):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">553</span>: <span class="c">#    print &#39;%s(%i,%i) %i&#39; % (level*&#39;   &#39;, node.index, node.val, node.rank)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">554</span>: <span class="c">#    if node.children:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">555</span>: <span class="c">#        print_node(leftmost_sibling(node.children), level+1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">556</span>: <span class="c">#    if node.right_sibling:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">557</span>: <span class="c">#        print_node(node.right_sibling, level)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">558</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">559</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">560</span>: <span class="c">#cdef void print_heap(FibonacciHeap* heap):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">561</span>: <span class="c">#    print &quot;---------------------------------&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">562</span>: <span class="c">#    print &quot;min node: (%i, %i)&quot; % (heap.min_node.index, heap.min_node.val)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">563</span>: <span class="c">#    if heap.min_node:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">564</span>: <span class="c">#        print_node(leftmost_sibling(heap.min_node))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">565</span>: <span class="c">#    else:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">566</span>: <span class="c">#        print &quot;[empty heap]&quot;</span></pre>
</div></body></html>
