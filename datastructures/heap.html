<!DOCTYPE html>
<!-- Generated by Cython 0.28.5 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: heap.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.28.5</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="heap.c">heap.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="sd">&quot;&quot;&quot;Cython implementation of a binary min heap.</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test_2, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="sd">Original author: Almar Klein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: <span class="sd">Modified by: Zachary Pincus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: <span class="sd">License: BSD</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: <span class="sd">Copyright 2009 Almar Klein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: <span class="sd">Redistribution and use in source and binary forms, with or without</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: <span class="sd">modification, are permitted provided that the following conditions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: <span class="sd">are met:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: <span class="sd">1. Redistributions of source code must retain the above copyright</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: <span class="sd">   notice, this list of conditions and the following disclaimer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: <span class="sd">2. Redistributions in binary form must reproduce the above copyright</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: <span class="sd">   notice, this list of conditions and the following disclaimer in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: <span class="sd">   documentation and/or other materials provided with the distribution.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: <span class="sd">THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS&#39;&#39; AND ANY EXPRESS OR</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: <span class="sd">IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: <span class="sd">OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: <span class="sd">IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: <span class="sd">INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: <span class="sd">NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: <span class="sd">DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: <span class="sd">THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: <span class="sd">(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: <span class="sd">THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>: <span class="k">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: <span class="c"># cython specific imports</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: <span class="k">import</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">malloc</span><span class="p">,</span> <span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;pyport.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>:   <span class="n">double</span> <span class="n">Py_HUGE_VAL</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>: <span class="k">cdef</span> <span class="kt">VALUE_T</span> <span class="nf">inf</span> <span class="o">=</span> <span class="n">Py_HUGE_VAL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_14datastructures_4heap_inf = Py_HUGE_VAL;
</pre><pre class="cython line score-0">&#xA0;<span class="">042</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>: <span class="c"># this is handy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">int_max</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE int __pyx_f_14datastructures_4heap_int_max(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  if (((__pyx_v_a &gt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">int_min</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE int __pyx_f_14datastructures_4heap_int_min(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  if (((__pyx_v_a &lt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">BinaryHeap</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap {
  void (*_add_or_remove_level)(struct __pyx_obj_14datastructures_4heap_BinaryHeap *, int);
  void (*_update)(struct __pyx_obj_14datastructures_4heap_BinaryHeap *);
  void (*_update_one)(struct __pyx_obj_14datastructures_4heap_BinaryHeap *, int);
  void (*_remove)(struct __pyx_obj_14datastructures_4heap_BinaryHeap *, int);
  int (*push_fast)(struct __pyx_obj_14datastructures_4heap_BinaryHeap *, double, int);
  double (*pop_fast)(struct __pyx_obj_14datastructures_4heap_BinaryHeap *);
};
static struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *__pyx_vtabptr_14datastructures_4heap_BinaryHeap;

</pre><pre class="cython line score-0">&#xA0;<span class="">049</span>:     <span class="sd">&quot;&quot;&quot; The binary heap class</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: <span class="sd">    BinaryHeap(initial_capacity=128)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: <span class="sd">    A binary heap is an object to store values in, optimized in such a way </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>: <span class="sd">    that the minimum (or maximum, but a minimum in this implementation) </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: <span class="sd">    value can be found in O(log2(N)) time. In this implementation, a reference</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>: <span class="sd">    value (a single integer) can also be stored with each value.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>: <span class="sd">    Use the methods push() and pop() to put in or extract values.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>: <span class="sd">    In C, use the corresponding push_fast() and pop_fast().</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>: <span class="sd">    An initial capacity can be provided if an estimate of the size of the heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>: <span class="sd">    is known in advance, but in any case the heap will dynamically resize.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: <span class="sd">    ----- Documentation -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: <span class="sd">    This implementation stores the binary heap in an array twice as long as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>: <span class="sd">    the number of elements in the heap. The array is structured in levels,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: <span class="sd">    starting at level 0 with a single value, doubling the amount of values in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: <span class="sd">    each level. The final level contains the actual values, the level before</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: <span class="sd">    it contains the pairwise minimum values. The level before that contains</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: <span class="sd">    the pairwise minimum values of that level, etc. Take a look at this</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: <span class="sd">    illustration:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: <span class="sd">    level: 0 11 2222 33333333 4444444444444444</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>: <span class="sd">    index: 0 12 3456 78901234 5678901234567890</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>: <span class="sd">                        1          2         3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>: <span class="sd">     The actual values are stored in level 4. The minimum value of position 15</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: <span class="sd">    and 16 is stored in position 7. min(17,18)-&gt;8, min(7,8)-&gt;3, min(3,4)-&gt;1.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: <span class="sd">    When adding a value, only the path to the top has to be updated, which</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: <span class="sd">    takesO(log2(N)) time.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: <span class="sd">     The advantage of this implementation relative to more common</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: <span class="sd">    implementations that swap values when pushing to the array is that data</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: <span class="sd">    only needs to be swapped once when an element is removed. This means that</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>: <span class="sd">    keeping an array of references along with the values is very inexpensive.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>: <span class="sd">    Th disadvantage is that if you pop the minimum value, the tree has to be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>: <span class="sd">    traced from top to bottom and back. So if you only want values and no</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>: <span class="sd">    references, this implementation will probably be slower. If you need</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>: <span class="sd">    references (and maybe cross references to be kept up to date) this</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>: <span class="sd">    implementation will be faster.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>: <span class="sd">     - count is the number of values </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>: <span class="sd">     - levels is the number of levels (levels is also the last level, such </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>: <span class="sd">       that 2**levels is the number of value in it)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>:     <span class="c">## Basic methods</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>:     <span class="c"># The following lines are always &quot;inlined&quot;, but documented here for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>:     <span class="c"># clarity:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>:     <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>:     <span class="c"># To calculate the start index of a certain level:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>:     <span class="c"># 2**l-1 # LevelStart</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>:     <span class="c"># Note that in inner loops, this may also be represented as (1&lt;&lt;l)-1, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>:     <span class="c"># because code of the form x**y goes via the python pow operations and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>:     <span class="c"># can thus be a bit slower.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>:     <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>:     <span class="c"># To calculate the corresponding ABSOLUTE index at the next level:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>:     <span class="c"># i*2+1 # CalcNextAbs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>:     <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>:     <span class="c"># To calculate the corresponding ABSOLUTE index at the previous level:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>:     <span class="c"># (i-1)/2 # CalcPrevAbs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>:     <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>:     <span class="c"># To calculate the capacity at a certain level:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">115</span>:     <span class="c"># 2**l</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">initial_capacity</span><span class="o">=</span><span class="mf">128</span><span class="p">):</span></pre>
<pre class='cython code score-30 '>/* Python wrapper */
static int __pyx_pw_14datastructures_4heap_10BinaryHeap_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14datastructures_4heap_10BinaryHeap___init__[] = "__init__(initial_capacity=128)\n        \n        Constructor: takes an optional parameter 'initial_capacity' so that\n        if the required heap capacity is known or can be estimated in advance,\n        there will need to be fewer resize operations on the heap.";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_14datastructures_4heap_10BinaryHeap___init__;
#endif
static int __pyx_pw_14datastructures_4heap_10BinaryHeap_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_initial_capacity;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_initial_capacity,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_initial_capacity);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_initial_capacity = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_initial_capacity == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
    } else {
      __pyx_v_initial_capacity = ((int)0x80);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.BinaryHeap.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14datastructures_4heap_10BinaryHeap___init__(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_initial_capacity);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_14datastructures_4heap_10BinaryHeap___init__(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self, int __pyx_v_initial_capacity) {
  int __pyx_v_levels;
  int __pyx_v_number;
  CYTHON_UNUSED __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.BinaryHeap.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">119</span>:         <span class="sd">&quot;&quot;&quot;__init__(initial_capacity=128)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">120</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>: <span class="sd">        Constructor: takes an optional parameter &#39;initial_capacity&#39; so that</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>: <span class="sd">        if the required heap capacity is known or can be estimated in advance,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>: <span class="sd">        there will need to be fewer resize operations on the heap.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:         <span class="c"># calc levels from the default capacity</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">levels</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_levels = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:         <span class="k">while</span> <span class="mf">2</span><span class="o">**</span><span class="n">levels</span> <span class="o">&lt;</span> <span class="n">initial_capacity</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = ((__Pyx_pow_long(2, ((long)__pyx_v_levels)) &lt; __pyx_v_initial_capacity) != 0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:             <span class="n">levels</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_levels = (__pyx_v_levels + 1);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">129</span>:         <span class="c"># set levels</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;min_levels = __pyx_v_levels;
  __pyx_v_self-&gt;levels = __pyx_v_levels;
</pre><pre class="cython line score-0">&#xA0;<span class="">131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>:         <span class="c"># we start with 0 values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;count = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">134</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">135</span>:         <span class="c"># allocate arrays</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">number</span> <span class="o">=</span> <span class="mf">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span></pre>
<pre class='cython code score-0 '>  __pyx_v_number = __Pyx_pow_long(2, ((long)__pyx_v_self-&gt;levels));
</pre><pre class="cython line score-0">&#xA0;<span class="">137</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">138</span>:         <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">VALUE_T</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span> <span class="mf">2</span><span class="o">*</span><span class="n">number</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">VALUE_T</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_t_14datastructures_4heap_VALUE_T *)malloc(((2 * __pyx_v_number) * (sizeof(__pyx_t_14datastructures_4heap_VALUE_T)))));
  __pyx_v_values = __pyx_t_2;
  __pyx_v_self-&gt;_values = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_references</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REFERENCE_T</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">number</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">REFERENCE_T</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_references = ((__pyx_t_14datastructures_4heap_REFERENCE_T *)malloc((__pyx_v_number * (sizeof(__pyx_t_14datastructures_4heap_REFERENCE_T)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">140</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_reset);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">142</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:     <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_3reset(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_14datastructures_4heap_10BinaryHeap_2reset[] = "Reset the heap to default, empty state.";
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_3reset(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reset (wrapper)", 0);
  __pyx_r = __pyx_pf_14datastructures_4heap_10BinaryHeap_2reset(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_10BinaryHeap_2reset(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  int __pyx_v_number;
  int __pyx_v_i;
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reset", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">144</span>:         <span class="sd">&quot;&quot;&quot;Reset the heap to default, empty state.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">number</span> <span class="o">=</span> <span class="mf">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span></pre>
<pre class='cython code score-0 '>  __pyx_v_number = __Pyx_pow_long(2, ((long)__pyx_v_self-&gt;levels));
</pre><pre class="cython line score-0">&#xA0;<span class="">146</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;_values;
  __pyx_v_values = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number</span><span class="o">*</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_number * 2);
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:             <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_values[__pyx_v_i]) = __pyx_v_14datastructures_4heap_inf;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">150</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:     <span class="k">def</span> <span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>/* Python wrapper */
static void __pyx_pw_14datastructures_4heap_10BinaryHeap_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_14datastructures_4heap_10BinaryHeap_5__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_14datastructures_4heap_10BinaryHeap_4__dealloc__(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_14datastructures_4heap_10BinaryHeap_4__dealloc__(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__", 0);
/* â€¦ */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_values != NULL) != 0);
  if (__pyx_t_1) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;_values);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_references</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_references != NULL) != 0);
  if (__pyx_t_1) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_references</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;_references);
</pre><pre class="cython line score-0">&#xA0;<span class="">157</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>:     <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_7__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_7__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_14datastructures_4heap_10BinaryHeap_6__str__(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_10BinaryHeap_6__str__(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  int __pyx_v_i0;
  int __pyx_v_i;
  int __pyx_v_level;
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.BinaryHeap.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">161</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i0</span><span class="p">,</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">n</span><span class="p">,</span> <span class="nf">level</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:         <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&#39;</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_);
  __pyx_v_s = __pyx_kp_s_;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:         <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;levels + 1);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 1; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_level = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:             <span class="n">i0</span> <span class="o">=</span> <span class="mf">2</span><span class="o">**</span><span class="n">level</span><span class="o">-</span><span class="mf">1</span> <span class="c"># LevelStart</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i0 = (__Pyx_pow_long(2, ((long)__pyx_v_level)) - 1);
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>:             <span class="n">s</span><span class="o">+=</span> <span class="s">&#39;level </span><span class="si">%i</span><span class="s">: &#39;</span> <span class="o">%</span> <span class="n">level</span></pre>
<pre class='cython code score-12 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_level);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_level_i, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 165, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="n">i0</span><span class="o">+</span><span class="mf">2</span><span class="o">**</span><span class="n">level</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = (__pyx_v_i0 + __Pyx_pow_long(2, ((long)__pyx_v_level)));
    __pyx_t_7 = __pyx_t_6;
    for (__pyx_t_8 = __pyx_v_i0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">167</span>:                 <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="si">%g</span><span class="s">, &#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-15 '>      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;_values[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 167, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_g, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 167, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_s, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 167, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_4);
      __pyx_t_4 = 0;
    }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>:             <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span></pre>
<pre class='cython code score-14 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_s, 0, -1L, NULL, NULL, &amp;__pyx_slice__2, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_5);
    __pyx_t_5 = 0;
  }
/* â€¦ */
  __pyx_slice__2 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__2)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:         <span class="k">return</span> <span class="n">s</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
  __pyx_r = __pyx_v_s;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">170</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>:     <span class="c">## C Maintanance methods</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_add_or_remove_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">add_or_remove</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_14datastructures_4heap_10BinaryHeap__add_or_remove_level(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self, int __pyx_v_add_or_remove) {
  int __pyx_v_i;
  int __pyx_v_i1;
  int __pyx_v_i2;
  int __pyx_v_n;
  int __pyx_v_new_levels;
  int __pyx_v_number;
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  __pyx_t_14datastructures_4heap_REFERENCE_T *__pyx_v_references;
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_old_values;
  __pyx_t_14datastructures_4heap_REFERENCE_T *__pyx_v_old_references;
/* â€¦ */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">175</span>:         <span class="c"># init indexing ints</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">i1</span><span class="p">,</span> <span class="nf">i2</span><span class="p">,</span> <span class="nf">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>:         <span class="c"># new amount of levels</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">new_levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">+</span> <span class="n">add_or_remove</span></pre>
<pre class='cython code score-0 '>  __pyx_v_new_levels = (__pyx_v_self-&gt;levels + __pyx_v_add_or_remove);
</pre><pre class="cython line score-0">&#xA0;<span class="">180</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>:         <span class="c"># allocate new arrays</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">number</span> <span class="o">=</span> <span class="mf">2</span><span class="o">**</span><span class="n">new_levels</span></pre>
<pre class='cython code score-0 '>  __pyx_v_number = __Pyx_pow_long(2, ((long)__pyx_v_new_levels));
</pre><pre class="cython line score-0">&#xA0;<span class="">183</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>:         <span class="k">cdef</span> <span class="kt">REFERENCE_T</span> *<span class="nf">references</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:         <span class="n">values</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">VALUE_T</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">number</span><span class="o">*</span><span class="mf">2</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">VALUE_T</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_values = ((__pyx_t_14datastructures_4heap_VALUE_T *)malloc(((__pyx_v_number * 2) * (sizeof(__pyx_t_14datastructures_4heap_VALUE_T)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>:         <span class="n">references</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REFERENCE_T</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">number</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">REFERENCE_T</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_references = ((__pyx_t_14datastructures_4heap_REFERENCE_T *)malloc((__pyx_v_number * (sizeof(__pyx_t_14datastructures_4heap_REFERENCE_T)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">187</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>:         <span class="c"># init arrays </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number</span><span class="o">*</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_number * 2);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:             <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_values[__pyx_v_i]) = __pyx_v_14datastructures_4heap_inf;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">191</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_number;
  __pyx_t_4 = __pyx_t_3;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">192</span>:             <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_references[__pyx_v_i]) = -1;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">193</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>:         <span class="c"># copy data</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">old_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;_values;
  __pyx_v_old_values = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:         <span class="k">cdef</span> <span class="kt">REFERENCE_T</span> *<span class="nf">old_references</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_references</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_self-&gt;_references;
  __pyx_v_old_references = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_v_self-&gt;count != 0);
  if (__pyx_t_8) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:             <span class="n">i1</span> <span class="o">=</span> <span class="mf">2</span><span class="o">**</span><span class="n">new_levels</span><span class="o">-</span><span class="mf">1</span> <span class="c"># LevelStart</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i1 = (__Pyx_pow_long(2, ((long)__pyx_v_new_levels)) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:             <span class="n">i2</span> <span class="o">=</span> <span class="mf">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="o">-</span><span class="mf">1</span> <span class="c"># LevelStart</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i2 = (__Pyx_pow_long(2, ((long)__pyx_v_self-&gt;levels)) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:             <span class="n">n</span> <span class="o">=</span> <span class="n">int_min</span><span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="n">new_levels</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n = __pyx_f_14datastructures_4heap_int_min(__Pyx_pow_long(2, ((long)__pyx_v_new_levels)), __Pyx_pow_long(2, ((long)__pyx_v_self-&gt;levels)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n;
    __pyx_t_4 = __pyx_t_3;
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:                 <span class="n">values</span><span class="p">[</span><span class="n">i1</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_values</span><span class="p">[</span><span class="n">i2</span><span class="o">+</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_values[(__pyx_v_i1 + __pyx_v_i)]) = (__pyx_v_old_values[(__pyx_v_i2 + __pyx_v_i)]);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_n;
    __pyx_t_4 = __pyx_t_3;
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:                 <span class="n">references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_references[__pyx_v_i]) = (__pyx_v_old_references[__pyx_v_i]);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">205</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">206</span>:         <span class="c"># make current</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:         <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_self-&gt;_values);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_references</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_self-&gt;_references);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_values = __pyx_v_values;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_references</span> <span class="o">=</span> <span class="n">references</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_references = __pyx_v_references;
</pre><pre class="cython line score-0">&#xA0;<span class="">211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">212</span>:         <span class="c"># we need a full update</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">new_levels</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;levels = __pyx_v_new_levels;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_update(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">215</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_14datastructures_4heap_10BinaryHeap__update(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  int __pyx_v_i0;
  int __pyx_v_i;
  int __pyx_v_ii;
  int __pyx_v_n;
  int __pyx_v_level;
/* â€¦ */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">218</span>:         <span class="sd">&quot;&quot;&quot;Update the full tree from the bottom up. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>: <span class="sd">        This should be done after resizing. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">221</span>:         <span class="c"># shorter name for values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;_values;
  __pyx_v_values = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">223</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">224</span>:         <span class="c"># Note that i represents an absolute index here</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">225</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i0</span><span class="p">,</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">ii</span><span class="p">,</span> <span class="nf">n</span><span class="p">,</span> <span class="nf">level</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">227</span>:         <span class="c"># track tree</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:         <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_2 = __pyx_v_self-&gt;levels; __pyx_t_2 &gt; 1; __pyx_t_2-=1) {
    __pyx_v_level = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:             <span class="n">i0</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="n">level</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span> <span class="c">#2**level-1 = LevelStart</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i0 = ((1 &lt;&lt; __pyx_v_level) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:             <span class="n">n</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">+</span> <span class="mf">1</span> <span class="c">#2**level</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n = (__pyx_v_i0 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="n">i0</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = (__pyx_v_i0 + __pyx_v_n);
    __pyx_t_4 = __pyx_t_3;
    for (__pyx_t_5 = __pyx_v_i0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=2) {
      __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:                 <span class="n">ii</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">//</span><span class="mf">2</span> <span class="c"># CalcPrevAbs</span></pre>
<pre class='cython code score-0 '>      __pyx_v_ii = __Pyx_div_long((__pyx_v_i - 1), 2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:                 <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = (((__pyx_v_values[__pyx_v_i]) &lt; (__pyx_v_values[(__pyx_v_i + 1)])) != 0);
      if (__pyx_t_6) {
/* â€¦ */
        goto __pyx_L7;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:                     <span class="n">values</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        (__pyx_v_values[__pyx_v_ii]) = (__pyx_v_values[__pyx_v_i]);
</pre><pre class="cython line score-0">&#xA0;<span class="">235</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:                     <span class="n">values</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        (__pyx_v_values[__pyx_v_ii]) = (__pyx_v_values[(__pyx_v_i + 1)]);
      }
      __pyx_L7:;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">238</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_update_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_14datastructures_4heap_10BinaryHeap__update_one(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self, int __pyx_v_i) {
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  int __pyx_v_ii;
  CYTHON_UNUSED int __pyx_v_level;
/* â€¦ */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">240</span>:         <span class="sd">&quot;&quot;&quot;Update the tree for one value.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">241</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">242</span>:         <span class="c"># shorter name for values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;_values;
  __pyx_v_values = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">244</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">245</span>:         <span class="c"># make index uneven</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:         <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mf">2</span><span class="o">==</span><span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__Pyx_mod_long(__pyx_v_i, 2) == 0) != 0);
  if (__pyx_t_2) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i = (__pyx_v_i - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">248</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>:         <span class="c"># track tree        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ii</span><span class="p">,</span> <span class="nf">level</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:         <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span><span class="mf">1</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_3 = __pyx_v_self-&gt;levels; __pyx_t_3 &gt; 1; __pyx_t_3-=1) {
    __pyx_v_level = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:             <span class="n">ii</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">//</span><span class="mf">2</span> <span class="c"># CalcPrevAbs</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ii = __Pyx_div_long((__pyx_v_i - 1), 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">253</span>:             <span class="c"># test</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:             <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (((__pyx_v_values[__pyx_v_i]) &lt; (__pyx_v_values[(__pyx_v_i + 1)])) != 0);
    if (__pyx_t_2) {
/* â€¦ */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:                 <span class="n">values</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_values[__pyx_v_ii]) = (__pyx_v_values[__pyx_v_i]);
</pre><pre class="cython line score-0">&#xA0;<span class="">256</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:                 <span class="n">values</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      (__pyx_v_values[__pyx_v_ii]) = (__pyx_v_values[(__pyx_v_i + 1)]);
    }
    __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">258</span>:             <span class="c"># next</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:             <span class="k">if</span> <span class="n">ii</span> <span class="o">%</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__Pyx_mod_long(__pyx_v_ii, 2) != 0);
    if (__pyx_t_2) {
/* â€¦ */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:                 <span class="n">i</span> <span class="o">=</span> <span class="n">ii</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = __pyx_v_ii;
</pre><pre class="cython line score-0">&#xA0;<span class="">261</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:                 <span class="n">i</span> <span class="o">=</span> <span class="n">ii</span><span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_i = (__pyx_v_ii - 1);
    }
    __pyx_L7:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">263</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">264</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i1</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_14datastructures_4heap_10BinaryHeap__remove(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self, int __pyx_v_i1) {
  int __pyx_v_levels;
  int __pyx_v_count;
  int __pyx_v_i0;
  int __pyx_v_i2;
  int __pyx_v_r1;
  int __pyx_v_r2;
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  __pyx_t_14datastructures_4heap_REFERENCE_T *__pyx_v_references;
/* â€¦ */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">266</span>:         <span class="sd">&quot;&quot;&quot;Remove a value from the heap. By index.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">267</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;levels;
  __pyx_v_levels = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;count;
  __pyx_v_count = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">270</span>:         <span class="c"># get indices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i0</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span>  <span class="c">#2**self.levels - 1 # LevelStart</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i0 = ((1 &lt;&lt; __pyx_v_levels) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i2</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">+</span> <span class="n">count</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i2 = ((__pyx_v_i0 + __pyx_v_count) - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">273</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">274</span>:         <span class="c"># get relative indices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">r1</span> <span class="o">=</span> <span class="n">i1</span> <span class="o">-</span> <span class="n">i0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_r1 = (__pyx_v_i1 - __pyx_v_i0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">r2</span> <span class="o">=</span> <span class="n">count</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_r2 = (__pyx_v_count - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">277</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;_values;
  __pyx_v_values = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:         <span class="k">cdef</span> <span class="kt">REFERENCE_T</span> *<span class="nf">references</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_references</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;_references;
  __pyx_v_references = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">280</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">281</span>:         <span class="c"># swap with last        </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:         <span class="n">values</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_values[__pyx_v_i1]) = (__pyx_v_values[__pyx_v_i2]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:         <span class="n">references</span><span class="p">[</span><span class="n">r1</span><span class="p">]</span> <span class="o">=</span> <span class="n">references</span><span class="p">[</span><span class="n">r2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_references[__pyx_v_r1]) = (__pyx_v_references[__pyx_v_r2]);
</pre><pre class="cython line score-0">&#xA0;<span class="">284</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">285</span>:         <span class="c"># make last Null</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:         <span class="n">values</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_values[__pyx_v_i2]) = __pyx_v_14datastructures_4heap_inf;
</pre><pre class="cython line score-0">&#xA0;<span class="">287</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">288</span>:         <span class="c"># update</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">-=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;count = (__pyx_v_self-&gt;count - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:         <span class="n">count</span> <span class="o">-=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count = (__pyx_v_count - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">levels</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">min_levels</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">count</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">levels</span><span class="o">-</span><span class="mf">2</span><span class="p">))):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = (((__pyx_v_levels &gt; __pyx_v_self-&gt;min_levels) &amp; (__pyx_v_count &lt; (1 &lt;&lt; (__pyx_v_levels - 2)))) != 0);
  if (__pyx_t_4) {
/* â€¦ */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_add_or_remove_level</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_add_or_remove_level(__pyx_v_self, -1);
</pre><pre class="cython line score-0">&#xA0;<span class="">293</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_update_one</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    ((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_update_one(__pyx_v_self, __pyx_v_i1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_update_one</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_update_one(__pyx_v_self, __pyx_v_i2);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">296</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">297</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">298</span>:     <span class="c">## C Public methods</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">299</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">push_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">value</span><span class="p">,</span> <span class="nb">int</span> <span class="n">reference</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_14datastructures_4heap_10BinaryHeap_push_fast(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self, double __pyx_v_value, int __pyx_v_reference) {
  int __pyx_v_levels;
  int __pyx_v_count;
  int __pyx_v_i;
  int __pyx_r;
/* â€¦ */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">301</span>:         <span class="sd">&quot;&quot;&quot;The c-method for fast pushing.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>: <span class="sd">        Returns the index relative to the start of the last level in the heap.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>:         <span class="c"># We need to resize if currently it just fits.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;levels;
  __pyx_v_levels = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;count;
  __pyx_v_count = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:         <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="n">levels</span><span class="p">):</span><span class="c">#2**self.levels:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_count &gt;= (1 &lt;&lt; __pyx_v_levels)) != 0);
  if (__pyx_t_2) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_add_or_remove_level</span><span class="p">(</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_add_or_remove_level(__pyx_v_self, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:             <span class="n">levels</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_levels = (__pyx_v_levels + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">310</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">311</span>:         <span class="c"># insert new value</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">count</span> <span class="c"># LevelStart + n</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = (((1 &lt;&lt; __pyx_v_levels) - 1) + __pyx_v_count);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;_values[__pyx_v_i]) = __pyx_v_value;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_references</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">reference</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;_references[__pyx_v_count]) = __pyx_v_reference;
</pre><pre class="cython line score-0">&#xA0;<span class="">315</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">316</span>:         <span class="c"># update        </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;count = (__pyx_v_self-&gt;count + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_update_one</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_update_one(__pyx_v_self, __pyx_v_i);
</pre><pre class="cython line score-0">&#xA0;<span class="">319</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">320</span>:         <span class="c"># return </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>:         <span class="k">return</span> <span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_count;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">pop_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_14datastructures_4heap_10BinaryHeap_pop_fast(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  CYTHON_UNUSED int __pyx_v_level;
  int __pyx_v_i;
  int __pyx_v_levels;
  int __pyx_v_ir;
  double __pyx_v_value;
  double __pyx_r;
/* â€¦ */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">325</span>:         <span class="sd">&quot;&quot;&quot;The c-method for fast popping.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">326</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">327</span>: <span class="sd">        Returns the minimum value. The reference is put in self._popped_ref&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">328</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>:         <span class="c"># shorter name for values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">330</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;_values;
  __pyx_v_values = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">331</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">332</span>:         <span class="c"># init index. start at 1 because we start in level 1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">333</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">level</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">335</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;levels;
  __pyx_v_levels = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">336</span>:         <span class="c"># search tree (using absolute indices)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">337</span>:         <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">levels</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_levels;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 1; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_level = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>:             <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = (((__pyx_v_values[__pyx_v_i]) &lt; (__pyx_v_values[(__pyx_v_i + 1)])) != 0);
    if (__pyx_t_5) {
/* â€¦ */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">339</span>:                 <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mf">2</span><span class="o">+</span><span class="mf">1</span> <span class="c"># CalcNextAbs</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = ((__pyx_v_i * 2) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">340</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">341</span>:                 <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">*</span><span class="mf">2</span><span class="o">+</span><span class="mf">1</span> <span class="c"># CalcNextAbs</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_i = (((__pyx_v_i + 1) * 2) + 1);
    }
    __pyx_L5:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>:         <span class="c"># select best one in last level</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>:         <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (((__pyx_v_values[__pyx_v_i]) &lt; (__pyx_v_values[(__pyx_v_i + 1)])) != 0);
  if (__pyx_t_5) {
/* â€¦ */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">345</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">347</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_i = (__pyx_v_i + 1);
  }
  __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">348</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>:         <span class="c"># get values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ir</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="p">((</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="c">#(2**self.levels-1) # LevelStart</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ir = (__pyx_v_i - ((1 &lt;&lt; __pyx_v_levels) - 1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">351</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">value</span> <span class="o">=</span>  <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_value = (__pyx_v_values[__pyx_v_i]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_popped_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_references</span><span class="p">[</span><span class="n">ir</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_popped_ref = (__pyx_v_self-&gt;_references[__pyx_v_ir]);
</pre><pre class="cython line score-0">&#xA0;<span class="">353</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">354</span>:         <span class="c"># remove it</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:         <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">inf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = ((__pyx_v_value != __pyx_v_14datastructures_4heap_inf) != 0);
  if (__pyx_t_5) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_remove(__pyx_v_self, __pyx_v_i);
</pre><pre class="cython line score-0">&#xA0;<span class="">357</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">358</span>:         <span class="c"># return </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:         <span class="k">return</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_value;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">360</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">361</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">362</span>:     <span class="c">## Python Public methods (that do not need to be VERY fast)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">363</span>: </pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:     <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">value</span><span class="p">,</span> <span class="nb">int</span> <span class="n">reference</span><span class="o">=-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_9push(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14datastructures_4heap_10BinaryHeap_8push[] = "push(value, reference=-1)\n        \n        Append a value to the heap, with optional reference. ";
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_9push(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_value;
  int __pyx_v_reference;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("push (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_value,&amp;__pyx_n_s_reference,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_value)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_reference);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "push") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_value == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L3_error)</span>
    if (values[1]) {
      __pyx_v_reference = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_reference == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L3_error)</span>
    } else {
      __pyx_v_reference = ((int)-1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("push", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.BinaryHeap.push", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14datastructures_4heap_10BinaryHeap_8push(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_value, __pyx_v_reference);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_10BinaryHeap_8push(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self, double __pyx_v_value, int __pyx_v_reference) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("push", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">365</span>:         <span class="sd">&quot;&quot;&quot;push(value, reference=-1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">366</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">367</span>: <span class="sd">        Append a value to the heap, with optional reference. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">push_fast</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  (void)(((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;push_fast(__pyx_v_self, __pyx_v_value, __pyx_v_reference));
</pre><pre class="cython line score-0">&#xA0;<span class="">369</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">370</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:     <span class="k">def</span> <span class="nf">min_val</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_11min_val(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_14datastructures_4heap_10BinaryHeap_10min_val[] = "Get the minimum value.\n       \n        Returns only the value, and does not remove it from the heap.";
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_11min_val(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("min_val (wrapper)", 0);
  __pyx_r = __pyx_pf_14datastructures_4heap_10BinaryHeap_10min_val(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_10BinaryHeap_10min_val(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("min_val", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.BinaryHeap.min_val", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">372</span>:         <span class="sd">&quot;&quot;&quot;Get the minimum value.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">373</span>: <span class="sd">       </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">374</span>: <span class="sd">        Returns only the value, and does not remove it from the heap.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">376</span>:         <span class="c"># shorter name for values</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;_values;
  __pyx_v_values = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">378</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>:         <span class="c"># select best one in last level</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:         <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">values</span><span class="p">[</span><span class="mf">2</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((__pyx_v_values[1]) &lt; (__pyx_v_values[2])) != 0);
  if (__pyx_t_2) {
/* â€¦ */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">381</span>:             <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_values[1]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">382</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:             <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_values[2]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 383, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">384</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:     <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_13values(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_14datastructures_4heap_10BinaryHeap_12values[] = "Get the values in the heap as a list.";
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_13values(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("values (wrapper)", 0);
  __pyx_r = __pyx_pf_14datastructures_4heap_10BinaryHeap_12values(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_10BinaryHeap_12values(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  PyObject *__pyx_v_out = NULL;
  int __pyx_v_i;
  int __pyx_v_i0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("values", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.BinaryHeap.values", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">387</span>:         <span class="sd">&quot;&quot;&quot;Get the values in the heap as a list.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">388</span>:         <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">389</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">i0</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:         <span class="n">i0</span> <span class="o">=</span> <span class="mf">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="o">-</span><span class="mf">1</span>  <span class="c"># LevelStart</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i0 = (__Pyx_pow_long(2, ((long)__pyx_v_self-&gt;levels)) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">391</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;count;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:             <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;_values[(__pyx_v_i0 + __pyx_v_i)]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_out, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">393</span>:         <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">394</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">395</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">396</span>:     <span class="k">def</span> <span class="nf">references</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_15references(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_14datastructures_4heap_10BinaryHeap_14references[] = "Get the references in the heap as a list.";
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_15references(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("references (wrapper)", 0);
  __pyx_r = __pyx_pf_14datastructures_4heap_10BinaryHeap_14references(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_10BinaryHeap_14references(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  PyObject *__pyx_v_out = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("references", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.BinaryHeap.references", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">397</span>:         <span class="sd">&quot;&quot;&quot;Get the references in the heap as a list.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">398</span>:         <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 398, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">399</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;count;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>:             <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_references</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_self-&gt;_references[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_out, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 401, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:         <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">404</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:     <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_17pop(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_14datastructures_4heap_10BinaryHeap_16pop[] = "Get the minimum value and remove it from the list. \n        \n        Returns a tuple of (value, reference) \n        If the queue is empty, an IndexError is raised.\n        ";
static PyObject *__pyx_pw_14datastructures_4heap_10BinaryHeap_17pop(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("pop (wrapper)", 0);
  __pyx_r = __pyx_pf_14datastructures_4heap_10BinaryHeap_16pop(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_10BinaryHeap_16pop(struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_self) {
  double __pyx_v_value;
  int __pyx_v_ref;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("pop", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.BinaryHeap.pop", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">406</span>:         <span class="sd">&quot;&quot;&quot;Get the minimum value and remove it from the list. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">407</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">408</span>: <span class="sd">        Returns a tuple of (value, reference) </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">409</span>: <span class="sd">        If the queue is empty, an IndexError is raised.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">410</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">411</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;count == 0) != 0);
  if (unlikely(__pyx_t_1)) {
/* â€¦ */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">412</span>:           <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s">&#39;pop from an empty heap&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_IndexError, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 412, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 412, __pyx_L1_error)</span>
/* â€¦ */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_pop_from_an_empty_heap);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 412, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>:         <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_fast</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_value = ((struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap *)__pyx_v_self-&gt;__pyx_vtab)-&gt;pop_fast(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">414</span>:         <span class="n">ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_popped_ref</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;_popped_ref;
  __pyx_v_ref = __pyx_t_3;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">415</span>:         <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">ref</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_ref);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">416</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">417</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">418</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">419</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">FastUpdateBinaryHeap</span><span class="p">(</span><span class="n">BinaryHeap</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap {
  struct __pyx_vtabstruct_14datastructures_4heap_BinaryHeap __pyx_base;
  double (*value_of_fast)(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *, int);
  int (*push_if_lower_fast)(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *, double, int);
};
static struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_vtabptr_14datastructures_4heap_FastUpdateBinaryHeap;
</pre><pre class="cython line score-0">&#xA0;<span class="">420</span>:     <span class="sd">&quot;&quot;&quot;FastUpdateBinaryHeap(initial_capacity=128, max_reference=None)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">421</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">422</span>: <span class="sd">    A binary heap that keeps cross-references so that the value of a given</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">423</span>: <span class="sd">    reference can be quickly queried (O(1) time) or updated (O(log2(N)) time).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">424</span>: <span class="sd">    This is ideal for pathfinding algorithms that implement some variant of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">425</span>: <span class="sd">    Dijkstra&#39;s algorithm.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">426</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">427</span>: <span class="sd">    At initialization, provide the largest reference value that might be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">428</span>: <span class="sd">    pushed to the heap. (Pushing a larger value will result in an error.) If</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">429</span>: <span class="sd">    no value is provided, 1-initial_capacity will be used. For the cross-</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">430</span>: <span class="sd">    reference index to work, all references must be in the range </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">431</span>: <span class="sd">    [0, max_reference]; references pushed outside of that range will not be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">432</span>: <span class="sd">    added to the heap.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">434</span>: <span class="sd">    The cross-references map data[reference]-&gt;internalindex, such that the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">435</span>: <span class="sd">    value corresponding to a given reference can be found efficiently. This</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">436</span>: <span class="sd">    can be queried with the value_of() method. (value_of_fast() in C)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">437</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">438</span>: <span class="sd">    Finally, note that a special method, push_if_lower() (push_if_lower_fast()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">439</span>: <span class="sd">    in C) is provided that will update the heap if the given reference is not</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">440</span>: <span class="sd">    in the heap, or if it is and the provided value is lower than the current</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">441</span>: <span class="sd">    value in the heap. This is again useful for pathfinding algorithms.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">442</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">443</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">444</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">initial_capacity</span><span class="o">=</span><span class="mf">128</span><span class="p">,</span> <span class="nb">int</span> <span class="n">max_reference</span><span class="o">=-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-43 '>/* Python wrapper */
static int __pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14datastructures_4heap_20FastUpdateBinaryHeap___init__[] = "__init__(initial_capacity=128, max_reference=None)\n        \n        Constructor: takes optional initial_capacity (but the heap size can \n        still grow dynamically) and max_reference (which is a max for the\n        lifetime of the heap, and sets a de-facto cap on the maximum heap\n        size.)";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_14datastructures_4heap_20FastUpdateBinaryHeap___init__;
#endif
static int __pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_initial_capacity;
  int __pyx_v_max_reference;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_initial_capacity,&amp;__pyx_n_s_max_reference,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_initial_capacity);
          if (value) { values[0] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_reference);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 444, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_initial_capacity = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_initial_capacity == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 444, __pyx_L3_error)</span>
    } else {
      __pyx_v_initial_capacity = ((int)0x80);
    }
    if (values[1]) {
      __pyx_v_max_reference = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_max_reference == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 444, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_reference = ((int)-1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 444, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap___init__(((struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self), __pyx_v_initial_capacity, __pyx_v_max_reference);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap___init__(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self, int __pyx_v_initial_capacity, int __pyx_v_max_reference) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">445</span>:         <span class="sd">&quot;&quot;&quot;__init__(initial_capacity=128, max_reference=None)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">446</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">447</span>: <span class="sd">        Constructor: takes optional initial_capacity (but the heap size can </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">448</span>: <span class="sd">        still grow dynamically) and max_reference (which is a max for the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">449</span>: <span class="sd">        lifetime of the heap, and sets a de-facto cap on the maximum heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">450</span>: <span class="sd">        size.)&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">451</span>:         <span class="k">if</span> <span class="n">max_reference</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_max_reference &lt; 0) != 0);
  if (__pyx_t_1) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">452</span>:           <span class="n">max_reference</span> <span class="o">=</span> <span class="n">initial_capacity</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_max_reference = (__pyx_v_initial_capacity - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">453</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">max_reference</span> <span class="o">=</span> <span class="n">max_reference</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;max_reference = __pyx_v_max_reference;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">454</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REFERENCE_T</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">((</span><span class="n">max_reference</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">REFERENCE_T</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_crossref = ((__pyx_t_14datastructures_4heap_REFERENCE_T *)malloc(((__pyx_v_max_reference + 1) * (sizeof(__pyx_t_14datastructures_4heap_REFERENCE_T)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">455</span>:         <span class="c"># below will call self.reset</span></pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">456</span>:         <span class="n">BinaryHeap</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_capacity</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_ptype_14datastructures_4heap_BinaryHeap), __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_initial_capacity);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, ((PyObject *)__pyx_v_self), __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, ((PyObject *)__pyx_v_self), __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, ((PyObject *)__pyx_v_self));
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">457</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">458</span>:     <span class="k">def</span> <span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>/* Python wrapper */
static void __pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_3__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_2__dealloc__(((struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_2__dealloc__(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__", 0);
/* â€¦ */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">459</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;_crossref != NULL) != 0);
  if (__pyx_t_1) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:             <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    free(__pyx_v_self-&gt;_crossref);
</pre><pre class="cython line score-0">&#xA0;<span class="">461</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:     <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_5reset(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_14datastructures_4heap_20FastUpdateBinaryHeap_4reset[] = "Reset the heap to default, empty state.";
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_5reset(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reset (wrapper)", 0);
  __pyx_r = __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_4reset(((struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_4reset(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self) {
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reset", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.reset", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">463</span>:         <span class="sd">&quot;&quot;&quot;Reset the heap to default, empty state.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">464</span>:         <span class="n">BinaryHeap</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_ptype_14datastructures_4heap_BinaryHeap), __pyx_n_s_reset);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, ((PyObject *)__pyx_v_self)};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, ((PyObject *)__pyx_v_self)};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_self));
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">465</span>:         <span class="c"># set default values of crossrefs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">466</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_reference</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_self-&gt;max_reference + 1);
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;_crossref[__pyx_v_i]) = -1;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">469</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">470</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">i1</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_14datastructures_4heap_20FastUpdateBinaryHeap__remove(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self, int __pyx_v_i1) {
  int __pyx_v_levels;
  int __pyx_v_count;
  int __pyx_v_i0;
  int __pyx_v_i2;
  int __pyx_v_r1;
  int __pyx_v_r2;
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  __pyx_t_14datastructures_4heap_REFERENCE_T *__pyx_v_references;
  __pyx_t_14datastructures_4heap_REFERENCE_T *__pyx_v_crossref;
/* â€¦ */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">472</span>:         <span class="sd">&quot;&quot;&quot; Remove a value from the heap. By index. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;__pyx_base.levels;
  __pyx_v_levels = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;__pyx_base.count;
  __pyx_v_count = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">475</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">476</span>:         <span class="c"># get indices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i0</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span>  <span class="c">#2**self.levels - 1 # LevelStart</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i0 = ((1 &lt;&lt; __pyx_v_levels) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">478</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i2</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">+</span> <span class="n">count</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i2 = ((__pyx_v_i0 + __pyx_v_count) - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">479</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">480</span>:         <span class="c"># get relative indices</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">481</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">r1</span> <span class="o">=</span> <span class="n">i1</span> <span class="o">-</span> <span class="n">i0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_r1 = (__pyx_v_i1 - __pyx_v_i0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">r2</span> <span class="o">=</span> <span class="n">count</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_r2 = (__pyx_v_count - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">483</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;__pyx_base._values;
  __pyx_v_values = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">485</span>:         <span class="k">cdef</span> <span class="kt">REFERENCE_T</span> *<span class="nf">references</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_references</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;__pyx_base._references;
  __pyx_v_references = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>:         <span class="k">cdef</span> <span class="kt">REFERENCE_T</span> *<span class="nf">crossref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;_crossref;
  __pyx_v_crossref = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">488</span>:         <span class="c"># update cross reference        </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:         <span class="n">crossref</span><span class="p">[</span><span class="n">references</span><span class="p">[</span><span class="n">r2</span><span class="p">]]</span><span class="o">=</span><span class="n">r1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_crossref[(__pyx_v_references[__pyx_v_r2])]) = __pyx_v_r1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:         <span class="n">crossref</span><span class="p">[</span><span class="n">references</span><span class="p">[</span><span class="n">r1</span><span class="p">]]</span><span class="o">=-</span><span class="mf">1</span>  <span class="c"># disable removed item</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_crossref[(__pyx_v_references[__pyx_v_r1])]) = -1;
</pre><pre class="cython line score-0">&#xA0;<span class="">491</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">492</span>:         <span class="c"># swap with last        </span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">493</span>:         <span class="n">values</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_values[__pyx_v_i1]) = (__pyx_v_values[__pyx_v_i2]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>:         <span class="n">references</span><span class="p">[</span><span class="n">r1</span><span class="p">]</span> <span class="o">=</span> <span class="n">references</span><span class="p">[</span><span class="n">r2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_references[__pyx_v_r1]) = (__pyx_v_references[__pyx_v_r2]);
</pre><pre class="cython line score-0">&#xA0;<span class="">495</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">496</span>:         <span class="c"># make last Null</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">497</span>:         <span class="n">values</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_values[__pyx_v_i2]) = __pyx_v_14datastructures_4heap_inf;
</pre><pre class="cython line score-0">&#xA0;<span class="">498</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">499</span>:         <span class="c"># update</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">500</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">-=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.count = (__pyx_v_self-&gt;__pyx_base.count - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>:         <span class="n">count</span> <span class="o">-=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count = (__pyx_v_count - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">502</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">levels</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">min_levels</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">count</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">levels</span><span class="o">-</span><span class="mf">2</span><span class="p">))):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = (((__pyx_v_levels &gt; __pyx_v_self-&gt;__pyx_base.min_levels) &amp; (__pyx_v_count &lt; (1 &lt;&lt; (__pyx_v_levels - 2)))) != 0);
  if (__pyx_t_4) {
/* â€¦ */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">503</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_add_or_remove_level</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base._add_or_remove_level(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), -1);
</pre><pre class="cython line score-0">&#xA0;<span class="">504</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">505</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_update_one</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    ((struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base._update_one(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_i1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_update_one</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base._update_one(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_i2);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">507</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">508</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">push_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">value</span><span class="p">,</span> <span class="nb">int</span> <span class="n">reference</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_14datastructures_4heap_20FastUpdateBinaryHeap_push_fast(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self, double __pyx_v_value, int __pyx_v_reference) {
  int __pyx_v_i;
  int __pyx_v_ir;
  int __pyx_r;
/* â€¦ */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">510</span>:         <span class="sd">&quot;&quot;&quot;The c method for fast pushing.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">511</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">512</span>: <span class="sd">        If the reference is already present, will update its value, otherwise</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">513</span>: <span class="sd">        will append it.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">514</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">515</span>: <span class="sd">        If -1 is returned, the provided reference was out-of-bounds and no </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">516</span>: <span class="sd">        value was pushed to the heap.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">517</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mf">0</span> <span class="o">&lt;=</span> <span class="n">reference</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_reference</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (0 &lt;= __pyx_v_reference);
  if (__pyx_t_1) {
    __pyx_t_1 = (__pyx_v_reference &lt;= __pyx_v_self-&gt;max_reference);
  }
  __pyx_t_2 = ((!(__pyx_t_1 != 0)) != 0);
  if (__pyx_t_2) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">518</span>:           <span class="k">return</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_r = -1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">519</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">520</span>:         <span class="c"># init variable to store the index-in-the-heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">521</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">522</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">523</span>:         <span class="c"># Reference is the index in the array where MCP is applied to.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">524</span>:         <span class="c"># Find the index-in-the-heap using the crossref array.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">525</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span><span class="p">[</span><span class="n">reference</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ir = (__pyx_v_self-&gt;_crossref[__pyx_v_reference]);
</pre><pre class="cython line score-0">&#xA0;<span class="">526</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">527</span>:         <span class="k">if</span> <span class="n">ir</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_ir != -1L) != 0);
  if (__pyx_t_2) {
/* â€¦ */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">528</span>:             <span class="c"># update</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">529</span>:             <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i = (((1 &lt;&lt; __pyx_v_self-&gt;__pyx_base.levels) - 1) + __pyx_v_ir);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">530</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base._values[__pyx_v_i]) = __pyx_v_value;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">531</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_update_one</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base._update_one(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">532</span>:             <span class="k">return</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_ir;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">533</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">534</span>:         <span class="c"># if not updated: append normally and store reference</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">535</span>:         <span class="n">ir</span> <span class="o">=</span> <span class="n">BinaryHeap</span><span class="o">.</span><span class="n">push_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ir = __pyx_f_14datastructures_4heap_10BinaryHeap_push_fast(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_value, __pyx_v_reference);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">536</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span><span class="p">[</span><span class="n">reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;_crossref[__pyx_v_reference]) = __pyx_v_ir;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">537</span>:         <span class="k">return</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_ir;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">538</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">539</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">push_if_lower_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">value</span><span class="p">,</span> <span class="nb">int</span> <span class="n">reference</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_14datastructures_4heap_20FastUpdateBinaryHeap_push_if_lower_fast(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self, double __pyx_v_value, int __pyx_v_reference) {
  int __pyx_v_i;
  int __pyx_v_ir;
  __pyx_t_14datastructures_4heap_VALUE_T *__pyx_v_values;
  int __pyx_r;
/* â€¦ */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">540</span>:         <span class="sd">&quot;&quot;&quot;If the reference is already present, will update its value ONLY if</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">541</span>: <span class="sd">        the new value is lower than the old one. If the reference is not</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">542</span>: <span class="sd">        present, this append it. If a value was appended, self._pushed is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">543</span>: <span class="sd">        set to 1.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">544</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">545</span>: <span class="sd">        If -1 is returned, the provided reference was out-of-bounds and no </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">546</span>: <span class="sd">        value was pushed to the heap.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">547</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">548</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mf">0</span> <span class="o">&lt;=</span> <span class="n">reference</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_reference</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (0 &lt;= __pyx_v_reference);
  if (__pyx_t_1) {
    __pyx_t_1 = (__pyx_v_reference &lt;= __pyx_v_self-&gt;max_reference);
  }
  __pyx_t_2 = ((!(__pyx_t_1 != 0)) != 0);
  if (__pyx_t_2) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">549</span>:             <span class="k">return</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_r = -1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">550</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">551</span>:         <span class="c"># init variable to store the index-in-the-heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">552</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">553</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">554</span>:         <span class="c"># Reference is the index in the array where MCP is applied to.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">555</span>:         <span class="c"># Find the index-in-the-heap using the crossref array.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">556</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span><span class="p">[</span><span class="n">reference</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ir = (__pyx_v_self-&gt;_crossref[__pyx_v_reference]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">557</span>:         <span class="k">cdef</span> <span class="kt">VALUE_T</span> *<span class="nf">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;__pyx_base._values;
  __pyx_v_values = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">558</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_pushed</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_pushed = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">559</span>:         <span class="k">if</span> <span class="n">ir</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_ir != -1L) != 0);
  if (__pyx_t_2) {
/* â€¦ */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">560</span>:             <span class="c"># update</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">561</span>:             <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i = (((1 &lt;&lt; __pyx_v_self-&gt;__pyx_base.levels) - 1) + __pyx_v_ir);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">562</span>:             <span class="k">if</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (((__pyx_v_values[__pyx_v_i]) &gt; __pyx_v_value) != 0);
    if (__pyx_t_2) {
/* â€¦ */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">563</span>:                 <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_values[__pyx_v_i]) = __pyx_v_value;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">564</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">_update_one</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base._update_one(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_i);
</pre><pre class="cython line score-0">&#xA0;<span class="">565</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">566</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">_pushed</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_self-&gt;_pushed = 0;
    }
    __pyx_L5:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">567</span>:             <span class="k">return</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_ir;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">568</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">569</span>:         <span class="c"># if not updated: append normally and store reference</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">570</span>:         <span class="n">ir</span> <span class="o">=</span> <span class="n">BinaryHeap</span><span class="o">.</span><span class="n">push_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ir = __pyx_f_14datastructures_4heap_10BinaryHeap_push_fast(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_value, __pyx_v_reference);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">571</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span><span class="p">[</span><span class="n">reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;_crossref[__pyx_v_reference]) = __pyx_v_ir;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">572</span>:         <span class="k">return</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_ir;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">573</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">574</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">575</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">value_of_fast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">reference</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_14datastructures_4heap_20FastUpdateBinaryHeap_value_of_fast(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self, int __pyx_v_reference) {
  int __pyx_v_i;
  int __pyx_v_ir;
  double __pyx_r;
/* â€¦ */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">576</span>:         <span class="sd">&quot;&quot;&quot;Return the value corresponding to the given reference. If inf</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">577</span>: <span class="sd">        is returned, the reference may be invalid: check the _invaild_ref</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">578</span>: <span class="sd">        field in this case.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">579</span>:         <span class="c"># init variable to store the index-in-the-heap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">580</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">581</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">582</span>:         <span class="c"># Reference is the index in the array where MCP is applied to.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">583</span>:         <span class="c"># Find the index-in-the-heap using the crossref array.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">584</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span><span class="p">[</span><span class="n">reference</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ir = (__pyx_v_self-&gt;_crossref[__pyx_v_reference]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">585</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_ref</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;_invalid_ref = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">586</span>:         <span class="k">if</span> <span class="n">ir</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ir == -1L) != 0);
  if (__pyx_t_1) {
/* â€¦ */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">587</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_ref</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;_invalid_ref = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">588</span>:             <span class="k">return</span> <span class="n">inf</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_14datastructures_4heap_inf;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">589</span>:         <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">ir</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = (((1 &lt;&lt; __pyx_v_self-&gt;__pyx_base.levels) - 1) + __pyx_v_ir);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">590</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_self-&gt;__pyx_base._values[__pyx_v_i]);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">591</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">592</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">593</span>:     <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">value</span><span class="p">,</span> <span class="nb">int</span> <span class="n">reference</span><span class="p">):</span></pre>
<pre class='cython code score-45 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_7push(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14datastructures_4heap_20FastUpdateBinaryHeap_6push[] = "push(value, reference)\n        \n        Append/update a value in the heap.\n        If the reference is already present, will update its value, otherwise\n        will append it.\n        ";
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_7push(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_value;
  int __pyx_v_reference;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("push (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_value,&amp;__pyx_n_s_reference,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_value)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_reference)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("push", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "push") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_value == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L3_error)</span>
    __pyx_v_reference = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_reference == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("push", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.push", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_6push(((struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self), __pyx_v_value, __pyx_v_reference);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_6push(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self, double __pyx_v_value, int __pyx_v_reference) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("push", 0);
/* â€¦ */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.push", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">594</span>:         <span class="sd">&quot;&quot;&quot;push(value, reference)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">595</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">596</span>: <span class="sd">        Append/update a value in the heap.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">597</span>: <span class="sd">        If the reference is already present, will update its value, otherwise</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">598</span>: <span class="sd">        will append it.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">599</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">600</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_fast</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.push_fast(((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_v_self), __pyx_v_value, __pyx_v_reference) == -1L) != 0);
  if (unlikely(__pyx_t_1)) {
/* â€¦ */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">601</span>:           <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;reference outside of range [0, max_reference]&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>
/* â€¦ */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_reference_outside_of_range_0_max);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class="cython line score-0">&#xA0;<span class="">602</span>: </pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">603</span>:     <span class="k">def</span> <span class="nf">push_if_lower</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">value</span><span class="p">,</span> <span class="nb">int</span> <span class="n">reference</span><span class="p">):</span></pre>
<pre class='cython code score-44 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_9push_if_lower(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14datastructures_4heap_20FastUpdateBinaryHeap_8push_if_lower[] = "push_if_lower(value, reference)\n        \n        Append/update a value in the heap. If the reference is already in the \n        heap, update only of the new value is lower than the current one.\n        If the reference is not present, this will append it.\n        Returns True if an append/update occured, False if otherwise.\n        ";
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_9push_if_lower(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_value;
  int __pyx_v_reference;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("push_if_lower (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_value,&amp;__pyx_n_s_reference,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_value)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_reference)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("push_if_lower", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "push_if_lower") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_value = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_value == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L3_error)</span>
    __pyx_v_reference = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_reference == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("push_if_lower", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.push_if_lower", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_8push_if_lower(((struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self), __pyx_v_value, __pyx_v_reference);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_8push_if_lower(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self, double __pyx_v_value, int __pyx_v_reference) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("push_if_lower", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.push_if_lower", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">604</span>:         <span class="sd">&quot;&quot;&quot;push_if_lower(value, reference)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">605</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">606</span>: <span class="sd">        Append/update a value in the heap. If the reference is already in the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">607</span>: <span class="sd">        heap, update only of the new value is lower than the current one.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">608</span>: <span class="sd">        If the reference is not present, this will append it.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">609</span>: <span class="sd">        Returns True if an append/update occured, False if otherwise.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">610</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">611</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_if_lower_fast</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((((struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;push_if_lower_fast(__pyx_v_self, __pyx_v_value, __pyx_v_reference) == -1L) != 0);
  if (unlikely(__pyx_t_1)) {
/* â€¦ */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">612</span>:           <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;reference outside of range [0, max_reference]&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 612, __pyx_L1_error)</span>
/* â€¦ */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_reference_outside_of_range_0_max);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">613</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pushed</span> <span class="o">==</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((__pyx_v_self-&gt;_pushed == 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 613, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">614</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">615</span>:     <span class="k">def</span> <span class="nf">value_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">reference</span><span class="p">):</span></pre>
<pre class='cython code score-12 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_11value_of(PyObject *__pyx_v_self, PyObject *__pyx_arg_reference); /*proto*/
static char __pyx_doc_14datastructures_4heap_20FastUpdateBinaryHeap_10value_of[] = "value_of(reference)\n      \n      Get the value corresponding to a given reference already pushed into \n      the heap.\n      ";
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_11value_of(PyObject *__pyx_v_self, PyObject *__pyx_arg_reference) {
  int __pyx_v_reference;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("value_of (wrapper)", 0);
  assert(__pyx_arg_reference); {
    __pyx_v_reference = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_arg_reference); if (unlikely((__pyx_v_reference == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 615, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.value_of", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_10value_of(((struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self), ((int)__pyx_v_reference));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_10value_of(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self, int __pyx_v_reference) {
  double __pyx_v_value;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("value_of", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.value_of", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">616</span>:       <span class="sd">&quot;&quot;&quot;value_of(reference)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">617</span>: <span class="sd">      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">618</span>: <span class="sd">      Get the value corresponding to a given reference already pushed into </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">619</span>: <span class="sd">      the heap.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">620</span>: <span class="sd">      &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">621</span>:       <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_of_fast</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_value = ((struct __pyx_vtabstruct_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;value_of_fast(__pyx_v_self, __pyx_v_reference);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">622</span>:       <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_ref</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;_invalid_ref != 0);
  if (unlikely(__pyx_t_1)) {
/* â€¦ */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">623</span>:           <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;invalid reference&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 623, __pyx_L1_error)</span>
/* â€¦ */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_invalid_reference);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">624</span>:       <span class="k">return</span> <span class="n">value</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">625</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">626</span>:     <span class="k">def</span> <span class="nf">cross_references</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_13cross_references(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_14datastructures_4heap_20FastUpdateBinaryHeap_12cross_references[] = "Get the cross references in the heap as a list.";
static PyObject *__pyx_pw_14datastructures_4heap_20FastUpdateBinaryHeap_13cross_references(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_references (wrapper)", 0);
  __pyx_r = __pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_12cross_references(((struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_20FastUpdateBinaryHeap_12cross_references(struct __pyx_obj_14datastructures_4heap_FastUpdateBinaryHeap *__pyx_v_self) {
  PyObject *__pyx_v_out = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_references", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.FastUpdateBinaryHeap.cross_references", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">627</span>:         <span class="sd">&quot;&quot;&quot;Get the cross references in the heap as a list.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">628</span>:         <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">629</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">630</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_reference</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_self-&gt;max_reference + 1);
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">631</span>:             <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_crossref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_self-&gt;_crossref[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_out, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 631, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">632</span>:         <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">633</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">634</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">635</span>: <span class="c">## TESTS</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">636</span>: </pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">637</span>: <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="nb">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">fast_update</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre>
<pre class='cython code score-56 '>/* Python wrapper */
static PyObject *__pyx_pw_14datastructures_4heap_1test(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14datastructures_4heap_test[] = "Test the binary heap.";
static PyMethodDef __pyx_mdef_14datastructures_4heap_1test = {"test", (PyCFunction)__pyx_pw_14datastructures_4heap_1test, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14datastructures_4heap_test};
static PyObject *__pyx_pw_14datastructures_4heap_1test(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_n;
  PyObject *__pyx_v_fast_update = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_fast_update,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_fast_update);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "test") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_n = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_n == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L3_error)</span>
    __pyx_v_fast_update = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.test", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14datastructures_4heap_test(__pyx_self, __pyx_v_n, __pyx_v_fast_update);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14datastructures_4heap_test(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_n, PyObject *__pyx_v_fast_update) {
  PyObject *__pyx_v_time = NULL;
  PyObject *__pyx_v_random = NULL;
  PyObject *__pyx_v_a = NULL;
  PyObject *__pyx_v_t0 = NULL;
  struct __pyx_obj_14datastructures_4heap_BinaryHeap *__pyx_v_h = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_b = NULL;
  PyObject *__pyx_v_t1 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.test", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_time);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_random);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_a);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_h);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_b);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_n, __pyx_n_s_fast_update, __pyx_n_s_time, __pyx_n_s_random, __pyx_n_s_a, __pyx_n_s_t0, __pyx_n_s_h, __pyx_n_s_i, __pyx_n_s_b, __pyx_n_s_t1);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_14datastructures_4heap_1test, NULL, __pyx_n_s_datastructures_heap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">638</span>:     <span class="sd">&quot;&quot;&quot;Test the binary heap.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">639</span>:     <span class="k">import</span> <span class="nn">time</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_time, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_time = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">640</span>:     <span class="k">import</span> <span class="nn">random</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_random, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_random = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">641</span>:     <span class="c"># generate random numbers with duplicates</span></pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">642</span>:     <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random, __pyx_n_s_seed);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* â€¦ */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">643</span>:     <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mf">2</span><span class="p">)]</span></pre>
<pre class='cython code score-67 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__Pyx_div_long(__pyx_v_n, 2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random, __pyx_n_s_uniform);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_6))) <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_a = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
/* â€¦ */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_float_1_0, __pyx_float_100_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">644</span>:     <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="n">a</span></pre>
<pre class='cython code score-6 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_a, __pyx_v_a);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 644, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_a, ((PyObject*)__pyx_t_2));
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">645</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">646</span>:     <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span></pre>
<pre class='cython code score-18 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_time, __pyx_n_s_clock);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_t0 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">648</span>:     <span class="c"># insert in heap with random removals</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">649</span>:     <span class="k">if</span> <span class="n">fast_update</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_fast_update); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* â€¦ */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">650</span>:         <span class="n">h</span> <span class="o">=</span> <span class="n">FastUpdateBinaryHeap</span><span class="p">(</span><span class="mf">128</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_128);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_128);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_128);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_14datastructures_4heap_FastUpdateBinaryHeap), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_h = ((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">651</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">652</span>:         <span class="n">h</span> <span class="o">=</span> <span class="n">BinaryHeap</span><span class="p">(</span><span class="mf">128</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  /*else*/ {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_14datastructures_4heap_BinaryHeap), __pyx_tuple__14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_v_h = ((struct __pyx_obj_14datastructures_4heap_BinaryHeap *)__pyx_t_2);
    __pyx_t_2 = 0;
  }
  __pyx_L5:;
/* â€¦ */
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_128);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">653</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span></pre>
<pre class='cython code score-53 '>  __pyx_t_4 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_a);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 653, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 653, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_5(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* â€¦ */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">654</span>:         <span class="n">h</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_h), __pyx_n_s_push);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_a, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_6)) {
      PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_3, __pyx_v_i};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_6)) {
      PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_3, __pyx_v_i};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (__pyx_t_8) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_v_i);
      __pyx_t_3 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">655</span>:         <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">25</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_a, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_25, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_7) {
/* â€¦ */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">656</span>:           <span class="c"># double-push same ref sometimes to test fast update codepaths</span></pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">657</span>:           <span class="n">h</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_h), __pyx_n_s_push);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_a, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      __pyx_t_9 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_9 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_3, __pyx_v_i};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_3, __pyx_v_i};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else
      #endif
      {
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        if (__pyx_t_10) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_10); __pyx_t_10 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_9, __pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_9, __pyx_v_i);
        __pyx_t_3 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">658</span>:         <span class="k">if</span> <span class="mf">25</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">50</span><span class="p">:</span></pre>
<pre class='cython code score-19 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_a, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_int_25, __pyx_t_6, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1)) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_int_50, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_7) {
/* â€¦ */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">659</span>:           <span class="c"># pop some to test random removal</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">660</span>:           <span class="n">h</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span></pre>
<pre class='cython code score-3 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Pop</span>(((PyObject *)__pyx_v_h));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">661</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">662</span>:     <span class="c"># pop from heap</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">663</span>:     <span class="n">b</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_v_b = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">664</span>:     <span class="k">while</span> <span class="bp">True</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">665</span>:         <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-13 '>    {
      /*try:*/ {
/* â€¦ */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      goto __pyx_L19_try_end;
      __pyx_L12_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
      goto __pyx_L1_error;
      __pyx_L17_try_break:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
      goto __pyx_L11_break;
      __pyx_L19_try_end:;
    }
  }
  __pyx_L11_break:;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">666</span>:             <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">pop</span><span class="p">()[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-8 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Pop</span>(((PyObject *)__pyx_v_h));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 666, __pyx_L12_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 666, __pyx_L12_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_b, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 666, __pyx_L12_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">667</span>:         <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span></pre>
<pre class='cython code score-6 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_IndexError);
      if (__pyx_t_9) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("datastructures.heap.test", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_2, &amp;__pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 667, __pyx_L14_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">668</span>:             <span class="k">break</span></pre>
<pre class='cython code score-3 '>        goto __pyx_L20_except_break;
        __pyx_L20_except_break:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L17_try_break;
      }
      goto __pyx_L14_except_error;
      __pyx_L14_except_error:;
</pre><pre class="cython line score-0">&#xA0;<span class="">669</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">670</span>:     <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span></pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_time, __pyx_n_s_clock);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_t1 = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">671</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">672</span>:     <span class="c"># verify</span></pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">673</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)):</span></pre>
<pre class='cython code score-61 '>  __pyx_t_4 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_b);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 673, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6)) {
    __pyx_t_2 = __pyx_t_6; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 673, __pyx_L1_error)</span>
        #else
        __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        #endif
      } else {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 673, __pyx_L1_error)</span>
        #else
        __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 673, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        #endif
      }
    } else {
      __pyx_t_6 = __pyx_t_5(__pyx_t_2);
      if (unlikely(!__pyx_t_6)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 673, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_6);
    __pyx_t_6 = 0;
/* â€¦ */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">674</span>:         <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-17 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_b, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 674, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 674, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_b, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 674, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_8, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 674, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 674, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_7) {
/* â€¦ */
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">675</span>:             <span class="k">print</span> <span class="s">&#39;error in order!&#39;</span></pre>
<pre class='cython code score-2 '>      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_error_in_order) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 675, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">676</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">677</span>:     <span class="k">print</span> <span class="s">&#39;elapsed time:&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="o">-</span><span class="n">t0</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_t1, __pyx_v_t0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_elapsed_time);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_elapsed_time);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_s_elapsed_time);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_Print</span>(0, __pyx_t_1, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">678</span>:     <span class="k">return</span> <span class="n">b</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b);
  __pyx_r = __pyx_v_b;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">679</span>: </pre>
</div></body></html>
